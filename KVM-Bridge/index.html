
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Michael Hubbard (rikosintie)">
      
      
        <link rel="canonical" href="https://rikosintie.github.io/Ubuntu4NetworkEngineers/KVM-Bridge/">
      
      
        <link rel="prev" href="../SSH/">
      
      
        <link rel="next" href="../Join-Ubuntu-24.04-desktop-to-AD/">
      
      
      <link rel="icon" href="../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>KVM - Ubuntu for Network Engineers</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      
  
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
    
      
      
    
  
  
  <style>:root{--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M0%208a8%208%200%201%201%2016%200A8%208%200%200%201%200%208m8-6.5a6.5%206.5%200%201%200%200%2013%206.5%206.5%200%200%200%200-13M6.5%207.75A.75.75%200%200%201%207.25%207h1a.75.75%200%200%201%20.75.75v2.75h.25a.75.75%200%200%201%200%201.5h-2a.75.75%200%200%201%200-1.5h.25v-2h-.25a.75.75%200%200%201-.75-.75M8%206a1%201%200%201%201%200-2%201%201%200%200%201%200%202%22/%3E%3C/svg%3E');--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M1%207.775V2.75C1%201.784%201.784%201%202.75%201h5.025c.464%200%20.91.184%201.238.513l6.25%206.25a1.75%201.75%200%200%201%200%202.474l-5.026%205.026a1.75%201.75%200%200%201-2.474%200l-6.25-6.25A1.75%201.75%200%200%201%201%207.775m1.5%200c0%20.066.026.13.073.177l6.25%206.25a.25.25%200%200%200%20.354%200l5.025-5.025a.25.25%200%200%200%200-.354l-6.25-6.25a.25.25%200%200%200-.177-.073H2.75a.25.25%200%200%200-.25.25ZM6%205a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M3.499.75a.75.75%200%200%201%201.5%200v.996C5.9%202.903%206.793%203.65%207.662%204.376l.24.202c-.036-.694.055-1.422.426-2.163C9.1.873%2010.794-.045%2012.622.26%2014.408.558%2016%201.94%2016%204.25c0%201.278-.954%202.575-2.44%202.734l.146.508.065.22c.203.701.412%201.455.476%202.226.142%201.707-.4%203.03-1.487%203.898C11.714%2014.671%2010.27%2015%208.75%2015h-6a.75.75%200%200%201%200-1.5h1.376a4.5%204.5%200%200%201-.563-1.191%203.84%203.84%200%200%201-.05-2.063%204.65%204.65%200%200%201-2.025-.293.75.75%200%200%201%20.525-1.406c1.357.507%202.376-.006%202.698-.318l.009-.01a.747.747%200%200%201%201.06%200%20.75.75%200%200%201-.012%201.074c-.912.92-.992%201.835-.768%202.586.221.74.745%201.337%201.196%201.621H8.75c1.343%200%202.398-.296%203.074-.836.635-.507%201.036-1.31.928-2.602-.05-.603-.216-1.224-.422-1.93l-.064-.221c-.12-.407-.246-.84-.353-1.29a2.4%202.4%200%200%201-.507-.441%203.1%203.1%200%200%201-.633-1.248.75.75%200%200%201%201.455-.364c.046.185.144.436.31.627.146.168.353.305.712.305.738%200%201.25-.615%201.25-1.25%200-1.47-.95-2.315-2.123-2.51-1.172-.196-2.227.387-2.706%201.345-.46.92-.27%201.774.019%203.062l.042.19.01.05c.348.443.666.949.94%201.553a.75.75%200%201%201-1.365.62c-.553-1.217-1.32-1.94-2.3-2.768L6.7%205.527c-.814-.68-1.75-1.462-2.692-2.619a3.7%203.7%200%200%200-1.023.88c-.406.495-.663%201.036-.722%201.508.116.122.306.21.591.239.388.038.797-.06%201.032-.19a.75.75%200%200%201%20.728%201.31c-.515.287-1.23.439-1.906.373-.682-.067-1.473-.38-1.879-1.193L.75%205.677V5.5c0-.984.48-1.94%201.077-2.664.46-.559%201.05-1.055%201.673-1.353z%22/%3E%3C/svg%3E');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M6.457%201.047c.659-1.234%202.427-1.234%203.086%200l6.082%2011.378A1.75%201.75%200%200%201%2014.082%2015H1.918a1.75%201.75%200%200%201-1.543-2.575Zm1.763.707a.25.25%200%200%200-.44%200L1.698%2013.132a.25.25%200%200%200%20.22.368h12.164a.25.25%200%200%200%20.22-.368Zm.53%203.996v2.5a.75.75%200%200%201-1.5%200v-2.5a.75.75%200%200%201%201.5%200M9%2011a1%201%200%201%201-2%200%201%201%200%200%201%202%200%22/%3E%3C/svg%3E');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M13.78%204.22a.75.75%200%200%201%200%201.06l-7.25%207.25a.75.75%200%200%201-1.06%200L2.22%209.28a.75.75%200%200%201%20.018-1.042.75.75%200%200%201%201.042-.018L6%2010.94l6.72-6.72a.75.75%200%200%201%201.06%200%22/%3E%3C/svg%3E');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M0%208a8%208%200%201%201%2016%200A8%208%200%200%201%200%208m8-6.5a6.5%206.5%200%201%200%200%2013%206.5%206.5%200%200%200%200-13M6.92%206.085h.001a.749.749%200%201%201-1.342-.67c.169-.339.436-.701.849-.977C6.845%204.16%207.369%204%208%204a2.76%202.76%200%200%201%201.637.525c.503.377.863.965.863%201.725%200%20.448-.115.83-.329%201.15-.205.307-.47.513-.692.662-.109.072-.22.138-.313.195l-.006.004a6%206%200%200%200-.26.16%201%201%200%200%200-.276.245.75.75%200%200%201-1.248-.832c.184-.264.42-.489.692-.661q.154-.1.313-.195l.007-.004c.1-.061.182-.11.258-.161a1%201%200%200%200%20.277-.245C8.96%206.514%209%206.427%209%206.25a.61.61%200%200%200-.262-.525A1.27%201.27%200%200%200%208%205.5c-.369%200-.595.09-.74.187a1%201%200%200%200-.34.398M9%2011a1%201%200%201%201-2%200%201%201%200%200%201%202%200%22/%3E%3C/svg%3E');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2.344%202.343za8%208%200%200%201%2011.314%2011.314A8.002%208.002%200%200%201%20.234%2010.089a8%208%200%200%201%202.11-7.746m1.06%2010.253a6.5%206.5%200%201%200%209.108-9.275%206.5%206.5%200%200%200-9.108%209.275M6.03%204.97%208%206.94l1.97-1.97a.749.749%200%200%201%201.275.326.75.75%200%200%201-.215.734L9.06%208l1.97%201.97a.749.749%200%200%201-.326%201.275.75.75%200%200%201-.734-.215L8%209.06l-1.97%201.97a.749.749%200%200%201-1.275-.326.75.75%200%200%201%20.215-.734L6.94%208%204.97%206.03a.75.75%200%200%201%20.018-1.042.75.75%200%200%201%201.042-.018%22/%3E%3C/svg%3E');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M9.504.43a1.516%201.516%200%200%201%202.437%201.713L10.415%205.5h2.123c1.57%200%202.346%201.909%201.22%203.004l-7.34%207.142a1.25%201.25%200%200%201-.871.354h-.302a1.25%201.25%200%200%201-1.157-1.723L5.633%2010.5H3.462c-1.57%200-2.346-1.909-1.22-3.004zm1.047%201.074L3.286%208.571A.25.25%200%200%200%203.462%209H6.75a.75.75%200%200%201%20.694%201.034l-1.713%204.188%206.982-6.793A.25.25%200%200%200%2012.538%207H9.25a.75.75%200%200%201-.683-1.06l2.008-4.418.003-.006-.004-.009-.006-.006-.008-.001q-.005%200-.009.004%22/%3E%3C/svg%3E');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M4.72.22a.75.75%200%200%201%201.06%200l1%20.999a3.5%203.5%200%200%201%202.441%200l.999-1a.748.748%200%200%201%201.265.332.75.75%200%200%201-.205.729l-.775.776c.616.63.995%201.493.995%202.444v.327q0%20.15-.025.292c.408.14.764.392%201.029.722l1.968-.787a.75.75%200%200%201%20.556%201.392L13%207.258V9h2.25a.75.75%200%200%201%200%201.5H13v.5q-.002.615-.141%201.186l2.17.868a.75.75%200%200%201-.557%201.392l-2.184-.873A5%205%200%200%201%208%2016a5%205%200%200%201-4.288-2.427l-2.183.873a.75.75%200%200%201-.558-1.392l2.17-.868A5%205%200%200%201%203%2011v-.5H.75a.75.75%200%200%201%200-1.5H3V7.258L.971%206.446a.75.75%200%200%201%20.558-1.392l1.967.787c.265-.33.62-.583%201.03-.722a1.7%201.7%200%200%201-.026-.292V4.5c0-.951.38-1.814.995-2.444L4.72%201.28a.75.75%200%200%201%200-1.06m.53%206.28a.75.75%200%200%200-.75.75V11a3.5%203.5%200%201%200%207%200V7.25a.75.75%200%200%200-.75-.75ZM6.173%205h3.654A.17.17%200%200%200%2010%204.827V4.5a2%202%200%201%200-4%200v.327c0%20.096.077.173.173.173%22/%3E%3C/svg%3E');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5%205.782V2.5h-.25a.75.75%200%200%201%200-1.5h6.5a.75.75%200%200%201%200%201.5H11v3.282l3.666%205.76C15.619%2013.04%2014.543%2015%2012.767%2015H3.233c-1.776%200-2.852-1.96-1.899-3.458Zm-2.4%206.565a.75.75%200%200%200%20.633%201.153h9.534a.75.75%200%200%200%20.633-1.153L12.225%2010.5h-8.45ZM9.5%202.5h-3V6c0%20.143-.04.283-.117.403L4.73%209h6.54L9.617%206.403A.75.75%200%200%201%209.5%206Z%22/%3E%3C/svg%3E');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M1.75%202.5h10.5a.75.75%200%200%201%200%201.5H1.75a.75.75%200%200%201%200-1.5m4%205h8.5a.75.75%200%200%201%200%201.5h-8.5a.75.75%200%200%201%200-1.5m0%205h8.5a.75.75%200%200%201%200%201.5h-8.5a.75.75%200%200%201%200-1.5M2.5%207.75v6a.75.75%200%200%201-1.5%200v-6a.75.75%200%200%201%201.5%200%22/%3E%3C/svg%3E');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="KVM - Ubuntu for Network Engineers" >
      
        <meta  property="og:description"  content="None" >
      
        <meta  property="og:image"  content="https://rikosintie.github.io/Ubuntu4NetworkEngineers/assets/images/social/KVM-Bridge.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://rikosintie.github.io/Ubuntu4NetworkEngineers/KVM-Bridge/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="KVM - Ubuntu for Network Engineers" >
      
        <meta  name="twitter:description"  content="None" >
      
        <meta  name="twitter:image"  content="https://rikosintie.github.io/Ubuntu4NetworkEngineers/assets/images/social/KVM-Bridge.png" >
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#kvm-install" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Ubuntu for Network Engineers" class="md-header__button md-logo" aria-label="Ubuntu for Network Engineers" data-md-component="logo">
      
  <img src="../img/ubuntu_icon1.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Ubuntu for Network Engineers
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              KVM
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/rikosintie/Ubuntu4NetworkEngineers" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    rikosintie/Ubuntu4NetworkEngineers
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../Introduction/" class="md-tabs__link">
        
  
  
    
  
  Intro

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../Ch01-Using-Ubuntu/" class="md-tabs__link">
        
  
  
    
  
  Usage

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../CH02-Install-Tools/" class="md-tabs__link">
        
  
  
    
  
  Desktop

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../terminal/" class="md-tabs__link">
        
  
  
    
  
  Terminal

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../wireless-tools/" class="md-tabs__link">
        
  
  
    
  
  WiFi Tools

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../Log_tools/" class="md-tabs__link">
        
  
  
    
  
  Log Tools

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../SSH/" class="md-tabs__link">
        
  
  
    
  
  SSH

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
  
    
  
  KVM

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../Join-Ubuntu-24.04-desktop-to-AD/" class="md-tabs__link">
        
  
  
    
  
  Add to AD

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Ubuntu for Network Engineers" class="md-nav__button md-logo" aria-label="Ubuntu for Network Engineers" data-md-component="logo">
      
  <img src="../img/ubuntu_icon1.png" alt="logo">

    </a>
    Ubuntu for Network Engineers
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/rikosintie/Ubuntu4NetworkEngineers" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    rikosintie/Ubuntu4NetworkEngineers
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Intro
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Ch01-Using-Ubuntu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Usage
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../CH02-Install-Tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Desktop
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../terminal/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Terminal
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../wireless-tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    WiFi Tools
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Log_tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Log Tools
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../SSH/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SSH
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    KVM
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    KVM
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installing-kvm" class="md-nav__link">
    <span class="md-ellipsis">
      Installing KVM
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installing KVM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#verifying-virtualization" class="md-nav__link">
    <span class="md-ellipsis">
      Verifying virtualization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-egrep" class="md-nav__link">
    <span class="md-ellipsis">
      Using egrep
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-cpu-checker" class="md-nav__link">
    <span class="md-ellipsis">
      Install cpu-checker
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-lscpu" class="md-nav__link">
    <span class="md-ellipsis">
      Use lscpu
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installing-the-packages-for-kvm" class="md-nav__link">
    <span class="md-ellipsis">
      Installing the packages for KVM
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installing the packages for KVM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#verify-the-ubuntu-version" class="md-nav__link">
    <span class="md-ellipsis">
      Verify the Ubuntu Version
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#make-sure-ubuntu-is-up-to-date" class="md-nav__link">
    <span class="md-ellipsis">
      Make sure Ubuntu is up to date
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-the-packages" class="md-nav__link">
    <span class="md-ellipsis">
      Install the packages
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-the-groups" class="md-nav__link">
    <span class="md-ellipsis">
      Configure the groups
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verify-the-groups-have-your-user" class="md-nav__link">
    <span class="md-ellipsis">
      Verify the groups have your user
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enable-the-virt-daemon" class="md-nav__link">
    <span class="md-ellipsis">
      Enable the virt daemon
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Enable the virt daemon">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#if-you-make-changes-and-need-to-restart-the-daemon" class="md-nav__link">
    <span class="md-ellipsis">
      If you make changes and need to restart the daemon
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#where-are-the-virt-files-stored" class="md-nav__link">
    <span class="md-ellipsis">
      Where are the virt files stored
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#back-up-qemuconf" class="md-nav__link">
    <span class="md-ellipsis">
      Back up qemu.conf
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-a-kvm-bridge" class="md-nav__link">
    <span class="md-ellipsis">
      Creating a KVM Bridge
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Creating a KVM Bridge">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-lan-information" class="md-nav__link">
    <span class="md-ellipsis">
      The LAN Information
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-the-bridge-utils-package" class="md-nav__link">
    <span class="md-ellipsis">
      Install the bridge-utils package
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-the-netplan-yaml-file" class="md-nav__link">
    <span class="md-ellipsis">
      Create the Netplan yaml file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#activate-the-bridge" class="md-nav__link">
    <span class="md-ellipsis">
      Activate the bridge
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#display-the-bridge" class="md-nav__link">
    <span class="md-ellipsis">
      Display the bridge
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#display-the-netplan-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Display the netplan configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ping-the-hosts-on-the-bridge" class="md-nav__link">
    <span class="md-ellipsis">
      Ping the hosts on the bridge
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list-out-the-xml-config-files" class="md-nav__link">
    <span class="md-ellipsis">
      list out the xml config files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verify-the-physical-network-switchport-settings" class="md-nav__link">
    <span class="md-ellipsis">
      Verify the physical network switchport settings
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#virsh-commands" class="md-nav__link">
    <span class="md-ellipsis">
      Virsh Commands
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Virsh Commands">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#view-saved-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      View saved configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#startstop-a-virtual-machine" class="md-nav__link">
    <span class="md-ellipsis">
      Start/stop a virtual machine
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#view-vm-details" class="md-nav__link">
    <span class="md-ellipsis">
      View VM Details
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-virtual-machine-status" class="md-nav__link">
    <span class="md-ellipsis">
      Check Virtual Machine status
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#list-virtual-machines" class="md-nav__link">
    <span class="md-ellipsis">
      List virtual machines
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connect-to-vm-console" class="md-nav__link">
    <span class="md-ellipsis">
      Connect to VM Console
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#view-dhcp-leases" class="md-nav__link">
    <span class="md-ellipsis">
      View DHCP leases
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#view-the-network-yaml-files" class="md-nav__link">
    <span class="md-ellipsis">
      View the network yaml files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edit-the-network-yaml-files" class="md-nav__link">
    <span class="md-ellipsis">
      Edit the network yaml files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#startstop-networks" class="md-nav__link">
    <span class="md-ellipsis">
      Start/Stop networks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#manually-create-the-bridge-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Manually create the bridge configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-a-windows-10-virtual-machine" class="md-nav__link">
    <span class="md-ellipsis">
      Create a Windows 10 virtual machine
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#start-the-virtual-machine" class="md-nav__link">
    <span class="md-ellipsis">
      Start the virtual machine
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install-the-qemu-guest-agent" class="md-nav__link">
    <span class="md-ellipsis">
      Install the qemu guest-agent
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Install the qemu guest-agent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mount-the-iso-image" class="md-nav__link">
    <span class="md-ellipsis">
      Mount the ISO image
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mount-the-iso-on-the-windows-guest" class="md-nav__link">
    <span class="md-ellipsis">
      Mount the iso on the Windows guest
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-the-guest-agent" class="md-nav__link">
    <span class="md-ellipsis">
      Install the Guest Agent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verify-that-the-guest-agent-is-running-on-windows" class="md-nav__link">
    <span class="md-ellipsis">
      Verify that the guest agent is running on Windows
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clean-up" class="md-nav__link">
    <span class="md-ellipsis">
      Clean up
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qemu-references" class="md-nav__link">
    <span class="md-ellipsis">
      QEMU References
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bridged-interface-with-vlans" class="md-nav__link">
    <span class="md-ellipsis">
      Bridged interface with vlans
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Bridged interface with vlans">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-vlan-information" class="md-nav__link">
    <span class="md-ellipsis">
      The VLAN Information
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disable-netfilter-for-bridged-interfaces" class="md-nav__link">
    <span class="md-ellipsis">
      Disable netfilter for bridged interfaces
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#netplan-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Netplan configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-the-yaml-file" class="md-nav__link">
    <span class="md-ellipsis">
      Create the yaml file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-the-new-network-settings" class="md-nav__link">
    <span class="md-ellipsis">
      Test the new network settings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#apply-the-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Apply the configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verify-an-yaml-file-before-modifying-production" class="md-nav__link">
    <span class="md-ellipsis">
      Verify an yaml file before modifying production
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-virtual-networks-using-virsh" class="md-nav__link">
    <span class="md-ellipsis">
      Configure virtual networks using virsh
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-networking-and-delete-the-default-network" class="md-nav__link">
    <span class="md-ellipsis">
      Check networking and delete the default network
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-the-networks" class="md-nav__link">
    <span class="md-ellipsis">
      Create the networks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enable-the-networks" class="md-nav__link">
    <span class="md-ellipsis">
      Enable the networks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#verify-the-networks" class="md-nav__link">
    <span class="md-ellipsis">
      Verify the networks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Verify the networks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#use-net-list" class="md-nav__link">
    <span class="md-ellipsis">
      Use net-list
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viewing-the-links" class="md-nav__link">
    <span class="md-ellipsis">
      Viewing the links
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#display-the-bridge-interfaces" class="md-nav__link">
    <span class="md-ellipsis">
      Display the bridge interfaces
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#display-the-ipv6-multicast-groups" class="md-nav__link">
    <span class="md-ellipsis">
      Display the ipv6 multicast groups
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitor-devices" class="md-nav__link">
    <span class="md-ellipsis">
      Monitor devices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attach-a-vm-to-vlan-40" class="md-nav__link">
    <span class="md-ellipsis">
      Attach a VM to vlan 40
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#traceroute-to-vlan-10" class="md-nav__link">
    <span class="md-ellipsis">
      traceroute to vlan 10
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#brctl-options" class="md-nav__link">
    <span class="md-ellipsis">
      brctl options
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#networkmanager-debug-logs" class="md-nav__link">
    <span class="md-ellipsis">
      NetworkManager debug logs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NetworkManager debug logs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#set-logging-back-to-info" class="md-nav__link">
    <span class="md-ellipsis">
      Set logging back to info
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reference-links" class="md-nav__link">
    <span class="md-ellipsis">
      Reference Links
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Join-Ubuntu-24.04-desktop-to-AD/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Add to AD
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="kvm-install">KVM Install</h1>
<p><img alt="screenshot" src="../img/Tux-KVM.jpeg" /></p>
<hr />
<p><img alt="▶" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/25b6.svg" title=":arrow_forward:" /> KEY TAKEAWAYS</p>
<ul>
<li>Ubuntu supports KVM virtualization on the desktop and server</li>
<li>KVM supports NATed and bridged interfaces just like VMware Fusion or workstation.</li>
<li>You create/manage KVM virtual machines with a GUI (virt-manager) or from the terminal (virsh commands)</li>
<li>KVM is updated automatically by Ubuntu so there are never package mismatches with the kernel.</li>
</ul>
<hr />
<h2 id="introduction">Introduction</h2>
<p>KVM is the Linux Kernel-mode Virtual Machine tool. It's free and easy to install on Ubuntu. With all the uncertainty around VMware workstation, it's worth knowing how to use KVM! Like everything else when switching to Linux, it will feel quite different than using VMware Workstation at first. But once you spend a couple days KVM and create a few virtual machines I think you will like it.</p>
<p>Plus, VMware is always way behind the Linux kernel so you have to resort to running the updates from <a href="https://github.com/mkubecek/vmware-host-modules">vmwware host modules</a> after you update Ubuntu. It's an ugly situation.</p>
<p>By default KVM creates virtual machines on a NATed interface with a dhcp address in the range of 192.168.122.2-.254. The linux package dnsmasq is used to provide the DNS/DHCP services. NAT enables connected guests to use the host physical machine IP address for communication to any external network.</p>
<p>The <code>default</code> network interface is <code>virbr0</code> and using <code>ip address device show virbr0</code> looks like this:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>ip<span class="w"> </span>address<span class="w"> </span>show<span class="w"> </span>device<span class="w"> </span>virbr0
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="m">20</span>:<span class="w"> </span>virbr0:<span class="w"> </span>&lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt;<span class="w"> </span>mtu<span class="w"> </span><span class="m">1500</span><span class="w"> </span>qdisc<span class="w"> </span>noqueue<span class="w"> </span>state<span class="w"> </span>DOWN<span class="w"> </span>group<span class="w"> </span>default<span class="w"> </span>qlen<span class="w"> </span><span class="m">1000</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">    </span>link/ether<span class="w"> </span><span class="m">52</span>:54:00:b5:48:b1<span class="w"> </span>brd<span class="w"> </span>ff:ff:ff:ff:ff:ff
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">    </span>inet<span class="w"> </span><span class="m">192</span>.168.122.1/24<span class="w"> </span>brd<span class="w"> </span><span class="m">192</span>.168.122.255<span class="w"> </span>scope<span class="w"> </span>global<span class="w"> </span>virbr0
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="w">       </span>valid_lft<span class="w"> </span>forever<span class="w"> </span>preferred_lft<span class="w"> </span>forever
</span></code></pre></div>
<hr />
<p><img alt="screenshot" src="../img/host-with-nat-switch.png" /></p>
<hr />
<p>As with VMware, you can create a bridge interface so that the virtual machine has an ip address on the same network as the host. Creating a bridge interface is explained <a href="#creating-a-kvm-bridge">below</a>. A network engineer will probably need a bridge interface.</p>
<hr />
<p><img alt="screenshot" src="../img/bridged-Mode.png" /></p>
<hr />
<p>The two Redhat links in the <a href="#reference-links">references</a> section have a lot of information on creating interfaces.</p>
<hr />
<h2 id="installing-kvm">Installing KVM</h2>
<p>To run KVM, you must have virtualization enabled at the BIOS level. It can be a challenge to find virtualization in the BIOS because different manufacturers call it different things. The easiest way to find out what virtualization is called on your PC is to google your motherboard model.</p>
<h3 id="verifying-virtualization">Verifying virtualization</h3>
<p>Once you have enabled virtualization in the BIOS, you should verify that it is seen by the CPU.</p>
<h3 id="using-egrep">Using egrep</h3>
<p>To verify that virtualization is enabled in BIOS, run:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>egrep<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;(vmx|svm)&#39;</span><span class="w"> </span>/proc/cpuinfo
</span></code></pre></div>
<p>48</p>
<p>This greps the /proc/cpuinfo file,  vmx is Intel, svm is AMD. You need to see a number in the output. In my case I have a 24 core Xeon processor that provides 48 cores of virtual CPUs.</p>
<h3 id="install-cpu-checker">Install cpu-checker</h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>cpu-checker<span class="w"> </span>-y
</span></code></pre></div>
<p>This is a optional package. From the Debian site:
"There are some CPU features that are filtered or disabled by system BIOSes. This set of tools seeks to help identify when certain features are in this state, based on kernel values, CPU flags and other conditions. Supported feature tests are NX/XD and VMX/SVM."</p>
<p>The tools is run using <code>kvm-ok</code> even though it's installed with <code>cpu-checker</code> for some reason. One advantage it has over grepping the /proc/cpuinfo file is that in some failure cases it will provide hints on what to do.</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span>
<span class="normal"><a href="#__codelineno-3-2">2</a></span>
<span class="normal"><a href="#__codelineno-3-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="hll">sudo<span class="w"> </span>kvm-ok
</span></span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2"></a>INFO:<span class="w"> </span>/dev/kvm<span class="w"> </span>exists
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3"></a>KVM<span class="w"> </span>acceleration<span class="w"> </span>can<span class="w"> </span>be<span class="w"> </span>used
</span></code></pre></div></td></tr></table></div>
<p>from <code>man kvm-ok</code> page:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>DESCRIPTION
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>    kvm-ok is a program that will determine if the system
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>    can host hardware accelerated KVM virtual machines.
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>    The program will first determine if `/proc/cpuinfo`
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>    contains the flags indicating that the CPU has the
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>    Virtualization Technology (VT) capability.
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>    Next, it will check if the /dev/kvm device exists.
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>    If running as root, it will check your CPU&#39;s MSRs
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>    to see if VT is disabled in the BIOS.
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a>    In some failure cases, kvm-ok provides hints on
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>    how you might go about enabling KVM on a system
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a>    where it is arbitrarily disabled.
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a>
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a>    If KVM can be used, this script will exit 0, otherwise it will exit non-zero.
</span></code></pre></div>
<h3 id="use-lscpu">Use lscpu</h3>
<p>lscpu is a built in tool to view cpu information. You can see on line 10 that the virtualization is VT-x:</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-5-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-5-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-5-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-5-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-5-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-5-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-5-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-5-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-5-10">10</a></span>
<span class="normal"><a href="#__codelineno-5-11">11</a></span>
<span class="normal"><a href="#__codelineno-5-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="hll">lscpu<span class="w"> </span><span class="p">|</span><span class="w"> </span>egrep<span class="w"> </span>-i<span class="w"> </span><span class="s1">&#39;Model name|Socket|Thread|NUMA|CPU\(s\)|virtual&#39;</span>
</span></span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2"></a>Address<span class="w"> </span>sizes:<span class="w">                        </span><span class="m">46</span><span class="w"> </span>bits<span class="w"> </span>physical,<span class="w"> </span><span class="m">48</span><span class="w"> </span>bits<span class="w"> </span>virtual
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3"></a>CPU<span class="o">(</span>s<span class="o">)</span>:<span class="w">                               </span><span class="m">24</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4"></a>On-line<span class="w"> </span>CPU<span class="o">(</span>s<span class="o">)</span><span class="w"> </span>list:<span class="w">                  </span><span class="m">0</span>-23
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5"></a>Model<span class="w"> </span>name:<span class="w">                           </span>Intel<span class="o">(</span>R<span class="o">)</span><span class="w"> </span>Xeon<span class="o">(</span>R<span class="o">)</span><span class="w"> </span>CPU<span class="w"> </span>E5-2697<span class="w"> </span>v2<span class="w"> </span>@<span class="w"> </span><span class="m">2</span>.70GHz
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6"></a>Thread<span class="o">(</span>s<span class="o">)</span><span class="w"> </span>per<span class="w"> </span>core:<span class="w">                   </span><span class="m">2</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7"></a>Core<span class="o">(</span>s<span class="o">)</span><span class="w"> </span>per<span class="w"> </span>socket:<span class="w">                   </span><span class="m">12</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8"></a>Socket<span class="o">(</span>s<span class="o">)</span>:<span class="w">                            </span><span class="m">1</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9"></a>CPU<span class="o">(</span>s<span class="o">)</span><span class="w"> </span>scaling<span class="w"> </span>MHz:<span class="w">                   </span><span class="m">48</span>%
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10"></a><span class="hll">Virtualization:<span class="w">                       </span>VT-x
</span></span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11"></a>NUMA<span class="w"> </span>node<span class="o">(</span>s<span class="o">)</span>:<span class="w">                         </span><span class="m">1</span>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12"></a>NUMA<span class="w"> </span>node0<span class="w"> </span>CPU<span class="o">(</span>s<span class="o">)</span>:<span class="w">                    </span><span class="m">0</span>-23
</span></code></pre></div></td></tr></table></div>
<h2 id="installing-the-packages-for-kvm">Installing the packages for KVM</h2>
<h3 id="verify-the-ubuntu-version">Verify the Ubuntu Version</h3>
<p>While  not technically necessary, you can verify the version of Ubuntu you have installed with:</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-6-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-6-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-6-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-6-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-6-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-6-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-6-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-6-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-6-10">10</a></span>
<span class="normal"><a href="#__codelineno-6-11">11</a></span>
<span class="normal"><a href="#__codelineno-6-12">12</a></span>
<span class="normal"><a href="#__codelineno-6-13">13</a></span>
<span class="normal"><a href="#__codelineno-6-14">14</a></span>
<span class="normal"><a href="#__codelineno-6-15">15</a></span>
<span class="normal"><a href="#__codelineno-6-16">16</a></span>
<span class="normal"><a href="#__codelineno-6-17">17</a></span>
<span class="normal"><a href="#__codelineno-6-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="hll">cat<span class="w"> </span>/etc/os-release
</span></span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2"></a>───────┬────────────────────────────────────────────────────────────────────────────────
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="w">       </span>│<span class="w"> </span>File:<span class="w"> </span>/etc/os-release
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4"></a>───────┼────────────────────────────────────────────────────────────────────────────────
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5"></a><span class="w">   </span><span class="m">1</span><span class="w">   </span>│<span class="w"> </span><span class="nv">PRETTY_NAME</span><span class="o">=</span><span class="s2">&quot;Ubuntu 24.04 LTS&quot;</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6"></a><span class="w">   </span><span class="m">2</span><span class="w">   </span>│<span class="w"> </span><span class="nv">NAME</span><span class="o">=</span><span class="s2">&quot;Ubuntu&quot;</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7"></a><span class="w">   </span><span class="m">3</span><span class="w">   </span>│<span class="w"> </span><span class="nv">VERSION_ID</span><span class="o">=</span><span class="s2">&quot;24.04&quot;</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8"></a><span class="w">   </span><span class="m">4</span><span class="w">   </span>│<span class="w"> </span><span class="nv">VERSION</span><span class="o">=</span><span class="s2">&quot;24.04 LTS (Noble Numbat)&quot;</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9"></a><span class="w">   </span><span class="m">5</span><span class="w">   </span>│<span class="w"> </span><span class="nv">VERSION_CODENAME</span><span class="o">=</span>noble
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10"></a><span class="w">   </span><span class="m">6</span><span class="w">   </span>│<span class="w"> </span><span class="nv">ID</span><span class="o">=</span>ubuntu
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11"></a><span class="w">   </span><span class="m">7</span><span class="w">   </span>│<span class="w"> </span><span class="nv">ID_LIKE</span><span class="o">=</span>debian
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12"></a><span class="w">   </span><span class="m">8</span><span class="w">   </span>│<span class="w"> </span><span class="nv">HOME_URL</span><span class="o">=</span><span class="s2">&quot;https://www.ubuntu.com/&quot;</span>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13"></a><span class="w">   </span><span class="m">9</span><span class="w">   </span>│<span class="w"> </span><span class="nv">SUPPORT_URL</span><span class="o">=</span><span class="s2">&quot;https://help.ubuntu.com/&quot;</span>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14"></a><span class="w">  </span><span class="m">10</span><span class="w">   </span>│<span class="w"> </span><span class="nv">BUG_REPORT_URL</span><span class="o">=</span><span class="s2">&quot;https://bugs.launchpad.net/ubuntu/&quot;</span>
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15"></a><span class="w">  </span><span class="m">11</span><span class="w">   </span>│<span class="w"> </span><span class="nv">PRI_POL_URL</span><span class="o">=</span><span class="s2">&quot;https://www.ubuntu.com/terms-and-policies/privacy-policy&quot;</span>
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16"></a><span class="w">  </span><span class="m">12</span><span class="w">   </span>│<span class="w"> </span><span class="nv">UBUNTU_CODENAME</span><span class="o">=</span>noble
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17"></a><span class="w">  </span><span class="m">13</span><span class="w">   </span>│<span class="w"> </span><span class="nv">LOGO</span><span class="o">=</span>ubuntu-logo
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18"></a>───────┴────────────────────────────────────────────────────────────────────────────────
</span></code></pre></div></td></tr></table></div>
<h3 id="make-sure-ubuntu-is-up-to-date">Make sure Ubuntu is up to date</h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>sudo<span class="w"> </span>apt<span class="w"> </span>upgrade
</span></code></pre></div>
<h3 id="install-the-packages">Install the packages</h3>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1">1</a></span>
<span class="normal"><a href="#__codelineno-8-2">2</a></span>
<span class="normal"><a href="#__codelineno-8-3">3</a></span>
<span class="normal"><a href="#__codelineno-8-4">4</a></span>
<span class="normal"><a href="#__codelineno-8-5">5</a></span>
<span class="normal"><a href="#__codelineno-8-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>libvirt-daemon
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>virt-manager
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>qemu-kvm
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>virtinst
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>libvirt-clients
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>bridge-utils
</span></code></pre></div></td></tr></table></div>
<p>or you can use this to install all at once:</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>libvirt-daemon<span class="w"> </span>virt-manager<span class="w"> </span>qemu-kvm<span class="w"> </span>virtinst<span class="w"> </span>libvirt-clients<span class="w"> </span>bridge-utils
</span></code></pre></div></td></tr></table></div>
<p>I prefer to do one package at time so that I can watch each package but either works. All packages are about 200MB.</p>
<h3 id="configure-the-groups">Configure the groups</h3>
<p>Your user has to be in the following groups</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1">1</a></span>
<span class="normal"><a href="#__codelineno-10-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1"></a>sudo<span class="w"> </span>usermod<span class="w"> </span>-aG<span class="w"> </span>kvm<span class="w"> </span><span class="nv">$USER</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2"></a>sudo<span class="w"> </span>usermod<span class="w"> </span>-aG<span class="w"> </span>libvirt<span class="w"> </span><span class="nv">$USER</span>
</span></code></pre></div></td></tr></table></div>
<h3 id="verify-the-groups-have-your-user">Verify the groups have your user</h3>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1">1</a></span>
<span class="normal"><a href="#__codelineno-11-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="hll">groups<span class="w"> </span><span class="nv">$USER</span>
</span></span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2"></a>mhubbard<span class="w"> </span>:<span class="w"> </span>mhubbard<span class="w"> </span>adm<span class="w"> </span>cdrom<span class="w"> </span>sudo<span class="w"> </span>dip<span class="w"> </span>plugdev<span class="w"> </span>users<span class="w"> </span>kvm<span class="w"> </span>lpadmin<span class="w"> </span>libvirt<span class="w"> </span>wireshark
</span></code></pre></div></td></tr></table></div>
<h2 id="enable-the-virt-daemon">Enable the virt daemon</h2>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1">1</a></span>
<span class="normal"><a href="#__codelineno-12-2">2</a></span>
<span class="normal"><a href="#__codelineno-12-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>--now<span class="w"> </span>libvirtd
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>libvirtd
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span>status<span class="w"> </span>libvirtd
</span></code></pre></div></td></tr></table></div>
<h3 id="if-you-make-changes-and-need-to-restart-the-daemon">If you make changes and need to restart the daemon</h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>libvirtd
</span></code></pre></div>
<h3 id="where-are-the-virt-files-stored">Where are the virt files stored</h3>
<p>The qemu files are located in /etc/libvirt. You can list the files using:</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-14-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-14-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-14-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-14-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-14-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-14-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-14-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-14-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-14-10">10</a></span>
<span class="normal"><a href="#__codelineno-14-11">11</a></span>
<span class="normal"><a href="#__codelineno-14-12">12</a></span>
<span class="normal"><a href="#__codelineno-14-13">13</a></span>
<span class="normal"><a href="#__codelineno-14-14">14</a></span>
<span class="normal"><a href="#__codelineno-14-15">15</a></span>
<span class="normal"><a href="#__codelineno-14-16">16</a></span>
<span class="normal"><a href="#__codelineno-14-17">17</a></span>
<span class="normal"><a href="#__codelineno-14-18">18</a></span>
<span class="normal"><a href="#__codelineno-14-19">19</a></span>
<span class="normal"><a href="#__codelineno-14-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="hll">ls<span class="w"> </span>-l<span class="w"> </span>/etc/libvirt
</span></span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2"></a>total<span class="w"> </span>126K
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3"></a>drwxr-xr-x<span class="w"> </span><span class="m">2</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">    </span><span class="m">2</span><span class="w"> </span><span class="m">2024</span>-05-06<span class="w"> </span><span class="m">06</span>:12<span class="w"> </span>hooks/
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4"></a>-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">  </span><span class="m">450</span><span class="w"> </span><span class="m">2024</span>-01-15<span class="w"> </span><span class="m">01</span>:58<span class="w"> </span>libvirt-admin.conf
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5"></a>-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">  </span><span class="m">547</span><span class="w"> </span><span class="m">2024</span>-01-15<span class="w"> </span><span class="m">01</span>:58<span class="w"> </span>libvirt.conf
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6"></a>-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">  </span>18K<span class="w"> </span><span class="m">2024</span>-05-06<span class="w"> </span><span class="m">06</span>:12<span class="w"> </span>libvirtd.conf
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7"></a>-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">2</span>.3K<span class="w"> </span><span class="m">2024</span>-01-15<span class="w"> </span><span class="m">01</span>:58<span class="w"> </span>libxl.conf
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8"></a>-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">2</span>.2K<span class="w"> </span><span class="m">2024</span>-05-06<span class="w"> </span><span class="m">06</span>:12<span class="w"> </span>libxl-lockd.conf
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9"></a>-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">2</span>.5K<span class="w"> </span><span class="m">2024</span>-05-06<span class="w"> </span><span class="m">06</span>:12<span class="w"> </span>libxl-sanlock.conf
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10"></a>-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">1</span>.2K<span class="w"> </span><span class="m">2024</span>-01-15<span class="w"> </span><span class="m">01</span>:58<span class="w"> </span>lxc.conf
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11"></a>drwxr-xr-x<span class="w"> </span><span class="m">2</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">   </span><span class="m">26</span><span class="w"> </span><span class="m">2024</span>-05-07<span class="w"> </span><span class="m">19</span>:47<span class="w"> </span>nwfilter/
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12"></a>drwxr-xr-x<span class="w"> </span><span class="m">4</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">    </span><span class="m">8</span><span class="w"> </span><span class="m">2024</span>-08-02<span class="w"> </span><span class="m">16</span>:44<span class="w"> </span>qemu/
</span><span id="__span-14-13"><a id="__codelineno-14-13" name="__codelineno-14-13"></a>-rw-------<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">  </span>38K<span class="w"> </span><span class="m">2024</span>-05-20<span class="w"> </span><span class="m">16</span>:17<span class="w"> </span>qemu.conf
</span><span id="__span-14-14"><a id="__codelineno-14-14" name="__codelineno-14-14"></a>-rw-------<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">  </span>38K<span class="w"> </span><span class="m">2024</span>-05-20<span class="w"> </span><span class="m">16</span>:15<span class="w"> </span>qemu.conf.bak
</span><span id="__span-14-15"><a id="__codelineno-14-15" name="__codelineno-14-15"></a>-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">2</span>.2K<span class="w"> </span><span class="m">2024</span>-05-06<span class="w"> </span><span class="m">06</span>:12<span class="w"> </span>qemu-lockd.conf
</span><span id="__span-14-16"><a id="__codelineno-14-16" name="__codelineno-14-16"></a>-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">2</span>.5K<span class="w"> </span><span class="m">2024</span>-05-06<span class="w"> </span><span class="m">06</span>:12<span class="w"> </span>qemu-sanlock.conf
</span><span id="__span-14-17"><a id="__codelineno-14-17" name="__codelineno-14-17"></a>drwx------<span class="w"> </span><span class="m">2</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">    </span><span class="m">2</span><span class="w"> </span><span class="m">2024</span>-05-07<span class="w"> </span><span class="m">19</span>:47<span class="w"> </span>secrets/
</span><span id="__span-14-18"><a id="__codelineno-14-18" name="__codelineno-14-18"></a>drwxr-xr-x<span class="w"> </span><span class="m">3</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">    </span><span class="m">5</span><span class="w"> </span><span class="m">2024</span>-05-08<span class="w"> </span><span class="m">21</span>:36<span class="w"> </span>storage/
</span><span id="__span-14-19"><a id="__codelineno-14-19" name="__codelineno-14-19"></a>-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">3</span>.0K<span class="w"> </span><span class="m">2024</span>-01-15<span class="w"> </span><span class="m">01</span>:58<span class="w"> </span>virtlockd.conf
</span><span id="__span-14-20"><a id="__codelineno-14-20" name="__codelineno-14-20"></a>-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">4</span>.0K<span class="w"> </span><span class="m">2024</span>-01-15<span class="w"> </span><span class="m">01</span>:58<span class="w"> </span>virtlogd.conf
</span></code></pre></div></td></tr></table></div>
<h3 id="back-up-qemuconf">Back up qemu.conf</h3>
<p>If you want to make any changes to the qemu.conf file I recommend making a backup first using:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>sudo<span class="w"> </span>cp<span class="w"> </span>/etc/libvirt/qemu.conf<span class="w"> </span>/etc/libvirt/qemu.conf.bak
</span></code></pre></div>
<p>Run the following to show the backup:</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1">1</a></span>
<span class="normal"><a href="#__codelineno-16-2">2</a></span>
<span class="normal"><a href="#__codelineno-16-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="hll">sudo<span class="w"> </span>ls<span class="w"> </span>-l<span class="w"> </span>/etc/libvirt/qemu.conf*
</span></span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2"></a>-rw-------<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">38439</span><span class="w"> </span>May<span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">16</span>:17<span class="w"> </span>/etc/libvirt/qemu.conf
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3"></a>-rw-------<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">38407</span><span class="w"> </span>May<span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">16</span>:15<span class="w"> </span>/etc/libvirt/qemu.conf.bak
</span></code></pre></div></td></tr></table></div>
<p>To list the qemu.conf file:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>sudo<span class="w"> </span>cat<span class="w"> </span>etc/libvirt/qemu.conf
</span></code></pre></div>
<p>To edit the qemu.conf file:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>sudo<span class="w"> </span>gnome-text-editor<span class="w"> </span>/etc/libvirt/qemu.conf
</span></code></pre></div>
<p>I didn't need to change the qemu.conf file for anything in this post. It's unlikely that you will need to but I wanted to show how to backup a file in the /etc/ directory.</p>
<hr />
<h2 id="creating-a-kvm-bridge">Creating a KVM Bridge</h2>
<p>Why do I need create a bridge?</p>
<p><strong>From the Tecmint link in the reference section below</strong></p>
<p>A typical use case of software network bridging is in a virtualization environment to connect virtual machines (VMs) directly to the host server network. This way, the VMs are deployed on the same subnet as the host and can access services such as DHCP and much more.</p>
<p>See the link <a href="https://developers.redhat.com/blog/2018/10/22/introduction-to-linux-interfaces-for-virtual-networking">Introduction to Linux interfaces for virtual networking</a> for a detailed tutorial on all the virtual interfaces that Linux supports. The list is impressive!</p>
<p>If you just need a virtual machine that is isolated on the host you can use the NAT interface that is built into KVM. Each guest will get an IP address in the range <code>192.16810.2 - 192.168.10.254</code>.</p>
<p>If you need a static address on the default network see <a href="https://www.cyberciti.biz/faq/linux-kvm-libvirt-dnsmasq-dhcp-static-ip-address-configuration-for-guest-os/">KVM libvirt assign static guest IP addresses using DHCP on the virtual machine</a></p>
<h3 id="the-lan-information">The LAN Information</h3>
<ul>
<li>LAN Network 192.168.10.0/24</li>
<li>Ubuntu workstation NIC - <code>eno1</code></li>
</ul>
<h3 id="install-the-bridge-utils-package">Install the bridge-utils package</h3>
<p>If you installed the <code>bridge-utils</code> package earlier you can skip this step.</p>
<p><code>sudo apt-get install bridge-utils</code></p>
<p>If you can't remember just run the command again. APT will tell you that the latest version is installed and exit.</p>
<h3 id="create-the-netplan-yaml-file">Create the Netplan yaml file</h3>
<ul>
<li><code>sudo touch etc/netplan/01-netcfg.yaml</code></li>
<li><code>sudo gnome-text-editor /etc/netplan/01-netcfg.yaml</code></li>
<li>Paste the following into the yaml file. Change IP addresses and interfaces to match your machine.</li>
</ul>
<div class="language-YAML highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">/etc/netplan/01-netcfg.yaml</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-19-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-19-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-19-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-19-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-19-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-19-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-19-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-19-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-19-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-19-10">10</a></span>
<span class="normal"><a href="#__codelineno-19-11">11</a></span>
<span class="normal"><a href="#__codelineno-19-12">12</a></span>
<span class="normal"><a href="#__codelineno-19-13">13</a></span>
<span class="normal"><a href="#__codelineno-19-14">14</a></span>
<span class="normal"><a href="#__codelineno-19-15">15</a></span>
<span class="normal"><a href="#__codelineno-19-16">16</a></span>
<span class="normal"><a href="#__codelineno-19-17">17</a></span>
<span class="normal"><a href="#__codelineno-19-18">18</a></span>
<span class="normal"><a href="#__codelineno-19-19">19</a></span>
<span class="normal"><a href="#__codelineno-19-20">20</a></span>
<span class="normal"><a href="#__codelineno-19-21">21</a></span>
<span class="normal"><a href="#__codelineno-19-22">22</a></span>
<span class="normal"><a href="#__codelineno-19-23">23</a></span>
<span class="normal"><a href="#__codelineno-19-24">24</a></span>
<span class="normal"><a href="#__codelineno-19-25">25</a></span>
<span class="normal"><a href="#__codelineno-19-26">26</a></span>
<span class="normal"><a href="#__codelineno-19-27">27</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1"></a><span class="c1"># This file describes the network interfaces available on your system</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2"></a><span class="c1"># For more information, see netplan(5).</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3"></a><span class="nt">network</span><span class="p">:</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4"></a><span class="w">  </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5"></a><span class="w">  </span><span class="nt">renderer</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networkd</span>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6"></a><span class="w">  </span><span class="nt">ethernets</span><span class="p">:</span>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7"></a><span class="w">      </span><span class="nt">eno1</span><span class="p">:</span>
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8"></a><span class="w">          </span><span class="nt">addresses</span><span class="p">:</span>
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9"></a><span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.10.235/24</span>
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10"></a>
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11"></a><span class="w">  </span><span class="nt">bridges</span><span class="p">:</span>
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12"></a><span class="w">    </span><span class="nt">br0</span><span class="p">:</span>
</span><span id="__span-19-13"><a id="__codelineno-19-13" name="__codelineno-19-13"></a><span class="w">      </span><span class="nt">interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">eno1</span><span class="w"> </span><span class="p p-Indicator">]</span>
</span><span id="__span-19-14"><a id="__codelineno-19-14" name="__codelineno-19-14"></a><span class="w">      </span><span class="nt">dhcp4</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</span><span id="__span-19-15"><a id="__codelineno-19-15" name="__codelineno-19-15"></a><span class="w">      </span><span class="nt">addresses</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">192.168.10.250/24</span><span class="p p-Indicator">]</span>
</span><span id="__span-19-16"><a id="__codelineno-19-16" name="__codelineno-19-16"></a><span class="w">      </span><span class="nt">routes</span><span class="p">:</span>
</span><span id="__span-19-17"><a id="__codelineno-19-17" name="__codelineno-19-17"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">to</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
</span><span id="__span-19-18"><a id="__codelineno-19-18" name="__codelineno-19-18"></a><span class="w">        </span><span class="nt">via</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.10.253</span>
</span><span id="__span-19-19"><a id="__codelineno-19-19" name="__codelineno-19-19"></a><span class="w">        </span><span class="nt">metric</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
</span><span id="__span-19-20"><a id="__codelineno-19-20" name="__codelineno-19-20"></a><span class="w">        </span><span class="nt">on-link</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-19-21"><a id="__codelineno-19-21" name="__codelineno-19-21"></a><span class="w">      </span><span class="nt">nameservers</span><span class="p">:</span>
</span><span id="__span-19-22"><a id="__codelineno-19-22" name="__codelineno-19-22"></a><span class="w">        </span><span class="nt">addresses</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1.1.1.1</span><span class="p p-Indicator">]</span>
</span><span id="__span-19-23"><a id="__codelineno-19-23" name="__codelineno-19-23"></a><span class="w">      </span><span class="nt">dhcp6</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yes</span>
</span><span id="__span-19-24"><a id="__codelineno-19-24" name="__codelineno-19-24"></a><span class="w">      </span><span class="nt">link-local</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="p p-Indicator">]</span>
</span><span id="__span-19-25"><a id="__codelineno-19-25" name="__codelineno-19-25"></a><span class="w">      </span><span class="nt">parameters</span><span class="p">:</span>
</span><span id="__span-19-26"><a id="__codelineno-19-26" name="__codelineno-19-26"></a><span class="w">        </span><span class="nt">stp</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-19-27"><a id="__codelineno-19-27" name="__codelineno-19-27"></a><span class="w">        </span><span class="nt">forward-delay</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span>
</span></code></pre></div></td></tr></table></div>
<p>Save the file, then change the permissions</p>
<p><code>sudo chmod 600 etc/netplan/01-netcfg.yaml</code></p>
<h3 id="activate-the-bridge">Activate the bridge</h3>
<p>You can use <code>sudo netplan try</code> to test the changes to 01-netcfg.yaml. If there are no errors just press <code>enter</code> to accept the changes.</p>
<p>Yaml is a pain to work with. You will probably have some errors in the beginning!</p>
<p>If you are sure that the yaml is correct you can use:</p>
<p><code>sudo netplan apply</code></p>
<p>to activate the file without testing. I recommend using <code>sudo netplan try</code> all the time.</p>
<p>This creates a bridge named br0 mastered to eno1.</p>
<p>Use <code>ip a</code> to view the interfaces:</p>
<p><code>eno1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast master br0 state UP group default qlen 1000</code></p>
<p><code>br0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000
    link/ether e6:b5:f8:a0:9b:c5 brd ff:ff:ff:ff:ff:ff
    inet 192.168.10.250/24 brd 192.168.10.255 scope global noprefixroute br0
       valid_lft forever preferred_lft forever</code></p>
<h3 id="display-the-bridge">Display the bridge</h3>
<div class="language-c# highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-20-1">1</a></span>
<span class="normal"><a href="#__codelineno-20-2">2</a></span>
<span class="normal"><a href="#__codelineno-20-3">3</a></span>
<span class="normal"><a href="#__codelineno-20-4">4</a></span>
<span class="normal"><a href="#__codelineno-20-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1"></a><span class="hll"><span class="n">sudo</span><span class="w"> </span><span class="n">brctl</span><span class="w"> </span><span class="n">show</span>
</span></span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2"></a><span class="n">bridge</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">bridge</span><span class="w"> </span><span class="n">id</span><span class="w">          </span><span class="n">STP</span><span class="w"> </span><span class="n">enabled</span><span class="w">  </span><span class="n">interfaces</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3"></a><span class="n">br0</span><span class="w">         </span><span class="mi">8000</span><span class="p">.</span><span class="n">e6b5f8a09bc5</span><span class="w">  </span><span class="n">yes</span><span class="w">          </span><span class="n">eno1</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4"></a><span class="w">                                            </span><span class="n">vnet3</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5"></a><span class="w">                                            </span><span class="n">vnet5</span>
</span></code></pre></div></td></tr></table></div>
<h3 id="display-the-netplan-configuration">Display the netplan configuration</h3>
<p>The following displays the system wide network configuration</p>
<p><code>sudo netplan get</code></p>
<h3 id="ping-the-hosts-on-the-bridge">Ping the hosts on the bridge</h3>
<p>The Window server is at 192.168.10.231 and the Windows 10 guest is at 192.168.10.232</p>
<div class="language-c# highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-21-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-21-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-21-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-21-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-21-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-21-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-21-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-21-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-21-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-21-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1"></a><span class="err">┌─</span><span class="p">[</span><span class="n">mhubbard@HP</span><span class="o">-</span><span class="n">Z420</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">[</span><span class="o">~</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">[</span><span class="mi">375</span><span class="p">]</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2"></a><span class="hll"><span class="err">└─</span><span class="p">[</span><span class="err">$</span><span class="p">]</span><span class="w"> </span><span class="n">ping</span><span class="w"> </span><span class="mf">192.168.10.231</span>
</span></span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3"></a><span class="n">PING</span><span class="w"> </span><span class="mf">192.168.10.231</span><span class="w"> </span><span class="p">(</span><span class="mf">192.168.10.231</span><span class="p">)</span><span class="w"> </span><span class="mi">56</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">data</span><span class="p">.</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4"></a><span class="mi">64</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mf">192.168.10.231</span><span class="p">:</span><span class="w"> </span><span class="n">icmp_seq</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">ttl</span><span class="o">=</span><span class="mi">128</span><span class="w"> </span><span class="n">time</span><span class="o">=</span><span class="mf">0.358</span><span class="w"> </span><span class="n">ms</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5"></a><span class="mi">64</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mf">192.168.10.231</span><span class="p">:</span><span class="w"> </span><span class="n">icmp_seq</span><span class="o">=</span><span class="mi">2</span><span class="w"> </span><span class="n">ttl</span><span class="o">=</span><span class="mi">128</span><span class="w"> </span><span class="n">time</span><span class="o">=</span><span class="mf">0.390</span><span class="w"> </span><span class="n">ms</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6"></a>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7"></a><span class="err">┌─</span><span class="p">[</span><span class="n">mhubbard@HP</span><span class="o">-</span><span class="n">Z420</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">[</span><span class="o">~</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">[</span><span class="mi">376</span><span class="p">]</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8"></a><span class="hll"><span class="err">└─</span><span class="p">[</span><span class="err">$</span><span class="p">]</span><span class="w"> </span><span class="n">ping</span><span class="w"> </span><span class="mf">192.168.10.232</span>
</span></span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9"></a><span class="n">PING</span><span class="w"> </span><span class="mf">192.168.10.232</span><span class="w"> </span><span class="p">(</span><span class="mf">192.168.10.232</span><span class="p">)</span><span class="w"> </span><span class="mi">56</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">data</span><span class="p">.</span>
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10"></a><span class="mi">64</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mf">192.168.10.232</span><span class="p">:</span><span class="w"> </span><span class="n">icmp_seq</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">ttl</span><span class="o">=</span><span class="mi">128</span><span class="w"> </span><span class="n">time</span><span class="o">=</span><span class="mf">0.657</span><span class="w"> </span><span class="n">ms</span>
</span></code></pre></div></td></tr></table></div>
<h3 id="list-out-the-xml-config-files">list out the xml config files</h3>
<p><code>l -la /etc/libvirt/qemu/networks</code></p>
<h3 id="verify-the-physical-network-switchport-settings">Verify the physical network switchport settings</h3>
<p>Make sure that the switchport of the physical network switch doesn't have bpdu-guard enabled! Once the bridge comes up it sends bpdu frames.</p>
<p>I was connected to a Cisco 3850 on an access port. The switch had <code>spanning-tree portfast bpduguard default</code> in global configuration. The port went into err-disabled when the bridge came up. It took me a while  to figure out why the bridge wasn't working!</p>
<p>I changed the port to a trunk with native vlan 10 to match the configuration that had been on the access port.</p>
<div class="language-c# highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-22-1">1</a></span>
<span class="normal"><a href="#__codelineno-22-2">2</a></span>
<span class="normal"><a href="#__codelineno-22-3">3</a></span>
<span class="normal"><a href="#__codelineno-22-4">4</a></span>
<span class="normal"><a href="#__codelineno-22-5">5</a></span>
<span class="normal"><a href="#__codelineno-22-6">6</a></span>
<span class="normal"><a href="#__codelineno-22-7">7</a></span>
<span class="normal"><a href="#__codelineno-22-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1"></a><span class="k">interface</span><span class="w"> </span><span class="n">GigabitEthernet1</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mi">6</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2"></a><span class="w"> </span><span class="n">description</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">HP</span><span class="w"> </span><span class="n">z420</span><span class="w"> </span><span class="o">&gt;</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3"></a><span class="w"> </span><span class="n">switchport</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">vlan</span><span class="w"> </span><span class="mi">10</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4"></a><span class="w"> </span><span class="n">switchport</span><span class="w"> </span><span class="n">trunk</span><span class="w"> </span><span class="n">native</span><span class="w"> </span><span class="n">vlan</span><span class="w"> </span><span class="mi">10</span>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5"></a><span class="w"> </span><span class="n">switchport</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">trunk</span>
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6"></a><span class="w"> </span><span class="n">storm</span><span class="o">-</span><span class="n">control</span><span class="w"> </span><span class="n">broadcast</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="mf">1.00</span><span class="w"> </span><span class="mf">0.50</span>
</span><span id="__span-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7"></a><span class="w"> </span><span class="n">storm</span><span class="o">-</span><span class="n">control</span><span class="w"> </span><span class="n">multicast</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="mf">1.00</span><span class="w"> </span><span class="mf">0.50</span>
</span><span id="__span-22-8"><a id="__codelineno-22-8" name="__codelineno-22-8"></a><span class="n">end</span>
</span></code></pre></div></td></tr></table></div>
<h2 id="virsh-commands">Virsh Commands</h2>
<h3 id="view-saved-configuration">View saved configuration</h3>
<ul>
<li><code>sudo virsh dumpxml win2k16 | grep -i 'bridge'</code> show bridge config for a host named win2k16</li>
<li><code>sudo virsh dumpxml win2k16 &gt; ~/win2k16.xml</code> Save the configuration for a host named win2k16</li>
</ul>
<h3 id="startstop-a-virtual-machine">Start/stop a virtual machine</h3>
<ul>
<li><code>sudo virsh win2k16 start</code> Start a virtual machine named win2k16</li>
<li><code>sudo virsh shutdown win2k16</code> Send an ACPI shutdown signal to the virtual machine</li>
<li><code>sudo virsh destroy win2k16</code> Power off the VM without signalling it. Data loss can occur</li>
<li><code>sudo virsh reboot</code> win2k16 Does not signal the VM. Data loss can occur</li>
</ul>
<h3 id="view-vm-details">View VM Details</h3>
<ul>
<li><code>sudo virsh dominfo win2k16</code> Show detailed information</li>
</ul>
<h3 id="check-virtual-machine-status">Check Virtual Machine status</h3>
<ul>
<li><code>sudo virsh domstate win2k16</code></li>
</ul>
<h3 id="list-virtual-machines">List virtual machines</h3>
<ul>
<li><code>sudo virsh list --all</code> List all vms including those not running</li>
<li><code>sudo virsh list</code> List all running vms</li>
</ul>
<h3 id="connect-to-vm-console">Connect to VM Console</h3>
<ul>
<li><code>sudo virsh console win2k16</code> See <a href="[#how-to-enable-kvm-virsh-console-access](https://ravada.readthedocs.io/en/latest/docs/config_console.html)">How to enable KVM virsh console access</a> for a detailed article on how to setup console access</li>
</ul>
<h3 id="view-dhcp-leases">View DHCP leases</h3>
<ul>
<li><code>sudo virsh net-dhcp-leases default</code> show dhcp leases on network default.</li>
<li><code>sudo virsh net-dhcp-leases host-bridge</code> show dhcp leases on network host-bridge.</li>
</ul>
<p>In the yaml file we disabled dhcp with <code>dhcp4: false</code> so there are no leases.</p>
<h3 id="view-the-network-yaml-files">View the network yaml files</h3>
<ul>
<li>sudo virsh netdumpxml default Show the configuration of the network named default</li>
<li>sudo virsh netdumpxml host-bridge Show the configuration of the network named host-bridge</li>
</ul>
<h3 id="edit-the-network-yaml-files">Edit the network yaml files</h3>
<ul>
<li>virsh net-edit default - Open the yaml configuration file of the  network <code>default</code> in the system editor</li>
<li>sudo virsh net-edit host-bridge - Open the yaml configuration file of the network <code>host-bridge</code> in the system editor</li>
</ul>
<h3 id="startstop-networks">Start/Stop networks</h3>
<ul>
<li>sudo virsh net-destroy default - Stop the network <code>default</code></li>
<li>sudo virsh net-start default Start the network <code>default</code></li>
</ul>
<h2 id="manually-create-the-bridge-configuration">Manually create the bridge configuration</h2>
<p>You can manually create the bridge and link it to eno1 from the terminal</p>
<div class="language-c# highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-23-1">1</a></span>
<span class="normal"><a href="#__codelineno-23-2">2</a></span>
<span class="normal"><a href="#__codelineno-23-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1"></a><span class="n">sudo</span><span class="w"> </span><span class="n">ip</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="k">add</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">br0</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">bridge</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2"></a><span class="n">sudo</span><span class="w"> </span><span class="n">ip</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="n">eno1</span><span class="w"> </span><span class="n">master</span><span class="w"> </span><span class="n">br0</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3"></a><span class="n">sudo</span><span class="w"> </span><span class="n">ip</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="k">add</span><span class="w"> </span><span class="mf">192.168.10.250</span><span class="o">/</span><span class="mi">16</span><span class="w"> </span><span class="n">brd</span><span class="w"> </span><span class="mf">192.168.10.255</span>
</span></code></pre></div></td></tr></table></div>
<p>This method will not survive a reboot but it's quick for testing.</p>
<hr />
<h2 id="create-a-windows-10-virtual-machine">Create a Windows 10 virtual machine</h2>
<p>Linux can't ship Windows drivers so you have to download the <code>virtio</code> package first. The Fedora People host the ISO <a href="https://fedorapeople.org/groups/virt/virtio-win/direct-downloads/stable-virtio/virtio-win.iso">here</a>. Save it to your <code>Downloads</code> directory.</p>
<p>You do not need the virtio ISO if you are creating a Linux virtual machine.</p>
<p>You will need the Windows ISO also. You can download it using this link - <a href="https://www.microsoft.com/en-us/software-download/windows10ISO">Windows 10 2023 Update | Version 22H2</a></p>
<p>Open the terminal and enter:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>virt-manager
</span></code></pre></div>
<p>Or hit the super key and type <code>virt</code> to bring up the virtual machine icon.</p>
<p>This will open the virt-manager GUI.</p>
<p>Click on the "New Virtual Machine" Icon.</p>
<p><img alt="screenshot" src="../img/virt-manager-new.png" /></p>
<p>Select "local install media (ISO image or CD-ROM)" and click forward.</p>
<p><img alt="screenshot" src="../img/virt-manager-new-VM.png" /></p>
<p>On this screen click "Browse" and select the Windows ISO and click "Forward". Notice that KVM identifies the ISO as Windows 11.</p>
<p><img alt="screenshot" src="../img/virt-manager-pick-ISO.png" /></p>
<p>Set the Memory and CPU sizes, click forward</p>
<p><img alt="screenshot" src="../img/virt-manager-memory.png" /></p>
<p>Set the disk size. Since this is a throw away virtual machine I set it to 20GB.</p>
<p><img alt="screenshot" src="../img/virt-manager-disksize.png" /></p>
<p>Click on "Select or create custom storage". Click "Manage..." and select the virtio ISO that you downloaded earlier.</p>
<p><img alt="screenshot" src="../img/virt-manager-virtio.png" /></p>
<p>Click Forward, this is the "ready to begin installation" dialog. Click "Customize before install".</p>
<p>Click forward and select the NIC</p>
<p><img alt="screenshot" src="../img/virt-manager-bridge.png" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You must follow the <a href="#creating-a-kvm-bridge">Creating a KVM Bridge</a> section first. If you just need a NAT virtual machine, you don't need to create a bridge. But you won't be able to remote desktop into the Windows virtual machine.</p>
</div>
<p>If you need a bridge, leave the NIC at NAT, finish creating the virtual machine, follow the instructions for creating a bridge, then go back and change the NIC to Bridge/Br0 using the Edit, Virtual Machine Details menu.</p>
<p>Click finish and the GUI based installation of Windows will begin. It's different than a Windows install on bare metal and you will see an image of the virtio drivers installing before the windows installation starts.</p>
<h2 id="start-the-virtual-machine">Start the virtual machine</h2>
<p>From the terminal you can open the Virtual Machine's GUI console using</p>
<p><code>virt-viewer</code></p>
<p><img alt="screenshot" src="../img/virt-viewer.png" /></p>
<p>Select the Win11 virtual machine anc click connect.</p>
<p>The GUI console will open:</p>
<p><img alt="screenshot" src="../img/virt-manager-running.png" /></p>
<p>Click the icon on the top left and select <code>Ctrl+Alt+Delete</code>.</p>
<p><img alt="screenshot" src="../img/virt-manager-ctrl%2Balt%2BDel.png" /></p>
<p><img alt="➡" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/27a1.svg" title=":arrow_right:" />  The VM says it's Windows 11 but it is actually Windows 10!</p>
<p><img alt="screenshot" src="../img/virt-manager-Win10.png" /></p>
<p>Congratulations, you now have a bridged Windows virtual machine up and running on Linux with KVM!</p>
<hr />
<h2 id="install-the-qemu-guest-agent">Install the qemu guest-agent</h2>
<p>The qemu-guest-agent is a helper daemon installed in a virtual machine (guest) when using QEMU. It is used to exchange information between the host and guest, and can be used to properly shut down the guest. The agent passes network information, including IP addresses, from the virtual machine to the host.</p>
<h3 id="mount-the-iso-image">Mount the ISO image</h3>
<p>We need to mount the virtio-win-<version>.iso image on the host</p>
<p><strong>On the Linux host</strong></p>
<p>Open a terminal and run these commands:</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-25-1">1</a></span>
<span class="normal"><a href="#__codelineno-25-2">2</a></span>
<span class="normal"><a href="#__codelineno-25-3">3</a></span>
<span class="normal"><a href="#__codelineno-25-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1"></a><span class="nb">cd</span><span class="w"> </span>/media
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2"></a>sudo<span class="w"> </span>mkdir<span class="w"> </span>iso
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3"></a>sudo<span class="w"> </span>mount<span class="w"> </span>-o<span class="w"> </span>loop<span class="w"> </span>~/Downloads/virtio-win-0.1.240.iso<span class="w"> </span>/media/iso
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4"></a>mount:<span class="w"> </span>/media/iso:<span class="w"> </span>WARNING:<span class="w"> </span><span class="nb">source</span><span class="w"> </span>write-protected,<span class="w"> </span>mounted<span class="w"> </span>read-only.
</span></code></pre></div></td></tr></table></div>
<p>Now the iso is mounted at /media/iso. It's read only but that's fine. We are not going to change anything.</p>
<p>Now change to the iso directory and list the files:</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-26-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-26-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-26-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-26-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-26-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-26-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-26-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-26-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-26-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-26-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1"></a><span class="hll"><span class="nb">cd</span><span class="w"> </span>iso
</span></span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2"></a><span class="hll">ls<span class="w"> </span>-l
</span></span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3"></a>total<span class="w"> </span>45M
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4"></a>dr-xr-xr-x<span class="w"> </span><span class="m">13</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">2</span>.0K<span class="w"> </span><span class="m">2023</span>-09-18<span class="w"> </span><span class="m">23</span>:17<span class="w"> </span>amd64/
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5"></a>dr-xr-xr-x<span class="w"> </span><span class="m">16</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">2</span>.0K<span class="w"> </span><span class="m">2023</span>-09-18<span class="w"> </span><span class="m">23</span>:17<span class="w"> </span>Balloon/
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6"></a>dr-xr-xr-x<span class="w">  </span><span class="m">2</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">2</span>.0K<span class="w"> </span><span class="m">2023</span>-09-18<span class="w"> </span><span class="m">23</span>:17<span class="w"> </span>cert/
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7"></a>dr-xr-xr-x<span class="w">  </span><span class="m">2</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">2</span>.0K<span class="w"> </span><span class="m">2023</span>-09-18<span class="w"> </span><span class="m">23</span>:17<span class="w"> </span>data/
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8"></a>dr-xr-xr-x<span class="w"> </span><span class="m">11</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">2</span>.0K<span class="w"> </span><span class="m">2023</span>-09-18<span class="w"> </span><span class="m">23</span>:17<span class="w"> </span>fwcfg/
</span><span id="__span-26-9"><a id="__codelineno-26-9" name="__codelineno-26-9"></a>dr-xr-xr-x<span class="w">  </span><span class="m">2</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">2</span>.0K<span class="w"> </span><span class="m">2023</span>-09-18<span class="w"> </span><span class="m">23</span>:18<span class="w"> </span>guest-agent/
</span><span id="__span-26-10"><a id="__codelineno-26-10" name="__codelineno-26-10"></a>...
</span></code></pre></div></td></tr></table></div>
<p>The file that we will be installing is in the guest-agent folder, qemu-ga-x86_64.msi.</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-27-1">1</a></span>
<span class="normal"><a href="#__codelineno-27-2">2</a></span>
<span class="normal"><a href="#__codelineno-27-3">3</a></span>
<span class="normal"><a href="#__codelineno-27-4">4</a></span>
<span class="normal"><a href="#__codelineno-27-5">5</a></span>
<span class="normal"><a href="#__codelineno-27-6">6</a></span>
<span class="normal"><a href="#__codelineno-27-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1"></a><span class="hll"><span class="nb">cd</span><span class="w"> </span>guest-agent
</span></span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2"></a>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3"></a>/media/iso/guest-agent
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4"></a><span class="hll">$<span class="w"> </span>ls<span class="w"> </span>-l
</span></span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5"></a>total<span class="w"> </span>20M
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6"></a>-r--r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">9</span>.6M<span class="w"> </span><span class="m">2023</span>-07-10<span class="w"> </span><span class="m">23</span>:17<span class="w"> </span>qemu-ga-i386.msi
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7"></a>-r--r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">9</span>.7M<span class="w"> </span><span class="m">2023</span>-07-10<span class="w"> </span><span class="m">23</span>:17<span class="w"> </span>qemu-ga-x86_64.msi
</span></code></pre></div></td></tr></table></div>
<h3 id="mount-the-iso-on-the-windows-guest">Mount the iso on the Windows guest</h3>
<p>Switch to <code>virt-manager</code> and open a console to the Windows host. Above the console, click the <code>Virtual Machine</code> menu and select <code>Redirect USB device</code>:</p>
<hr />
<p><img alt="screenshot" src="../img/Redirect-USB.png" /></p>
<hr />
<p>A dialog will open, select the <code>Generic Mass Storage</code> device.</p>
<hr />
<p><img alt="screenshot" src="../img/Select-Generic.png" /></p>
<hr />
<h3 id="install-the-guest-agent">Install the Guest Agent</h3>
<p>In the guest, open file Explorer and select the iso.</p>
<p>Double click on the guest-agent directory, then double click on <code>qemu-ga-x86_64.msi</code>. This is a standard Windows MSI installer, follow the directions and finish the install.</p>
<h3 id="verify-that-the-guest-agent-is-running-on-windows">Verify that the guest agent is running on Windows</h3>
<p>Open a PowerShell console</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-28-1">1</a></span>
<span class="normal"><a href="#__codelineno-28-2">2</a></span>
<span class="normal"><a href="#__codelineno-28-3">3</a></span>
<span class="normal"><a href="#__codelineno-28-4">4</a></span>
<span class="normal"><a href="#__codelineno-28-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1"></a><span class="hll">PS<span class="w"> </span>C:<span class="se">\U</span>sers<span class="se">\m</span>hubbard&gt;<span class="w"> </span>Get-Service<span class="w"> </span>QEMU-GA
</span></span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2"></a>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3"></a>Status<span class="w">   </span>Name<span class="w">               </span>DisplayName
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4"></a>------<span class="w">   </span>----<span class="w">               </span>-----------
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5"></a>Running<span class="w">  </span>QEMU-GA<span class="w">            </span>QEMU<span class="w"> </span>Guest<span class="w"> </span>Agent
</span></code></pre></div></td></tr></table></div>
<p>You will now be able to copy/paste between the guest/host and host/guest.</p>
<h3 id="clean-up">Clean up</h3>
<p>Now that the agent is installed, we need to eject the ISO from the guest and unmount the ISO from the host. In Files Explorer, right click over the DVD Drive: virtio-win-0.1.240 and select the <code>eject</code> option.</p>
<hr />
<p><img alt="screenshot" src="../img/Eject.png" /></p>
<hr />
<p>On the host, open a terminal (you can't be in the /media/iso directory or the unmount will fail):</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-29-1">1</a></span>
<span class="normal"><a href="#__codelineno-29-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1"></a><span class="nb">cd</span><span class="w"> </span>~
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2"></a>sudo<span class="w"> </span>umount<span class="w"> </span>/media/iso
</span></code></pre></div></td></tr></table></div>
<h3 id="qemu-references">QEMU References</h3>
<ul>
<li><a href="https://bbs.archlinux.org/viewtopic.php?id=295189">Issue with copy/paste in QEMU Windows guest</a></li>
<li><a href="https://pve.proxmox.com/wiki/Qemu-guest-agent">Qemu-guest-agent</a> - A ProxMox tutorial on the Guest Agent</li>
<li><a href="https://linuxiac.com/how-to-mount-iso-files-on-linux/">How to Mount ISO Files on Linux</a></li>
</ul>
<hr />
<h2 id="bridged-interface-with-vlans">Bridged interface with vlans</h2>
<p><img alt="▶" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/25b6.svg" title=":arrow_forward:" /> KEY TAKEAWAYS</p>
<ul>
<li>Ubuntu supports vlans by default on the desktop and server</li>
<li>KVM supports bridge interfaces with vlan tagging</li>
<li>The bridge interface uses STP by default</li>
<li>brctl has a rich set of tools for working with bridge interfaces</li>
<li>KVM supports <a href="https://www.ppenvswitch.org">Open vSwitch</a></li>
</ul>
<p>Why would you want to create a bridge interface with vlans? On the laptop that you carry around you probably wouldn't have a need to. But if you have an Ubuntu server setup in your lab you almost certainly will want to be able to segment your services.</p>
<p>This tutorial is based of of the official Ubuntu documentation for <a href="https://netplan.readthedocs.io/en/latest/single-nic-vm-host-with-vlans/">netplan</a>. I modified the tutorial to fit my lab server.</p>
<h3 id="the-vlan-information">The VLAN Information</h3>
<ul>
<li>LAN (untagged) Network 192.168.10.0/24</li>
<li>vlan 40 Surveillance 192.168.40.0/24</li>
<li>vlan 41 IoT 192.168.41.0/24</li>
<li>Ubuntu workstation NIC - <code>eno1</code></li>
</ul>
<p>Interface <code>eno1</code> is connected to a Cisco switch on port Gi1/0/6. The port has the following configuration:</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-30-1">1</a></span>
<span class="normal"><a href="#__codelineno-30-2">2</a></span>
<span class="normal"><a href="#__codelineno-30-3">3</a></span>
<span class="normal"><a href="#__codelineno-30-4">4</a></span>
<span class="normal"><a href="#__codelineno-30-5">5</a></span>
<span class="normal"><a href="#__codelineno-30-6">6</a></span>
<span class="normal"><a href="#__codelineno-30-7">7</a></span>
<span class="normal"><a href="#__codelineno-30-8">8</a></span>
<span class="normal"><a href="#__codelineno-30-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1"></a><span class="hll">interface<span class="w"> </span>GigabitEthernet1/0/6
</span></span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2"></a><span class="w"> </span>description<span class="w"> </span>&lt;<span class="w"> </span>HP<span class="w"> </span>z420<span class="w"> </span>&gt;
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3"></a><span class="w"> </span>switchport<span class="w"> </span>access<span class="w"> </span>vlan<span class="w"> </span><span class="m">10</span>
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4"></a><span class="w"> </span>switchport<span class="w"> </span>trunk<span class="w"> </span>native<span class="w"> </span>vlan<span class="w"> </span><span class="m">10</span>
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5"></a><span class="w"> </span>switchport<span class="w"> </span>trunk<span class="w"> </span>allowed<span class="w"> </span>vlan<span class="w"> </span><span class="m">10</span>,40,41
</span><span id="__span-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6"></a><span class="w"> </span>switchport<span class="w"> </span>mode<span class="w"> </span>trunk
</span><span id="__span-30-7"><a id="__codelineno-30-7" name="__codelineno-30-7"></a><span class="w"> </span>storm-control<span class="w"> </span>broadcast<span class="w"> </span>level<span class="w"> </span><span class="m">1</span>.00<span class="w"> </span><span class="m">0</span>.50
</span><span id="__span-30-8"><a id="__codelineno-30-8" name="__codelineno-30-8"></a><span class="w"> </span>storm-control<span class="w"> </span>multicast<span class="w"> </span>level<span class="w"> </span><span class="m">1</span>.00<span class="w"> </span><span class="m">0</span>.50
</span><span id="__span-30-9"><a id="__codelineno-30-9" name="__codelineno-30-9"></a>end
</span></code></pre></div></td></tr></table></div>
<p>Inter vlan routing is enabled and L3 interfaces are configured:</p>
<ul>
<li>vlan 40 - 192.168.10.235</li>
<li>vlan 41 - 192.168.41.235</li>
</ul>
<h3 id="disable-netfilter-for-bridged-interfaces">Disable netfilter for bridged interfaces</h3>
<p>To allow communication between the host server, its virtual machines, and the devices in the local VLANs, disable netfilter for bridged interfaces:</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">/etc/systemctl.conf</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-31-1">1</a></span>
<span class="normal"><a href="#__codelineno-31-2">2</a></span>
<span class="normal"><a href="#__codelineno-31-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1"></a><span class="hll">net.bridge.bridge-nf-call-iptables<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
</span></span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2"></a>net.bridge.bridge-nf-call-ip6tables<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3"></a>net.bridge.bridge-nf-call-arptables<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
</span></code></pre></div></td></tr></table></div>
<p>Apply the changes immediately, without rebooting the host.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>sysctl<span class="w"> </span>-p<span class="w"> </span>/etc/sysctl.conf
</span></code></pre></div>
<h3 id="netplan-configuration">Netplan configuration</h3>
<ul>
<li>Disable dhcp on the NIC</li>
<li>Create vlans 40, 41</li>
<li>Create three bridge interfaces, and assign IPv4 addresses to them:</li>
<li>br0: bridge on the untagged VLAN1 and the management interface of the server</li>
<li>br40: bridge on vlan40</li>
<li>br41: bridge on vlan41</li>
</ul>
<h3 id="create-the-yaml-file">Create the yaml file</h3>
<div class="language-yaml highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">/etc/netplan/01-netcfg.yaml</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-33-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-33-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-33-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-33-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-33-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-33-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-33-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-33-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-33-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-33-10">10</a></span>
<span class="normal"><a href="#__codelineno-33-11">11</a></span>
<span class="normal"><a href="#__codelineno-33-12">12</a></span>
<span class="normal"><a href="#__codelineno-33-13">13</a></span>
<span class="normal"><a href="#__codelineno-33-14">14</a></span>
<span class="normal"><a href="#__codelineno-33-15">15</a></span>
<span class="normal"><a href="#__codelineno-33-16">16</a></span>
<span class="normal"><a href="#__codelineno-33-17">17</a></span>
<span class="normal"><a href="#__codelineno-33-18">18</a></span>
<span class="normal"><a href="#__codelineno-33-19">19</a></span>
<span class="normal"><a href="#__codelineno-33-20">20</a></span>
<span class="normal"><a href="#__codelineno-33-21">21</a></span>
<span class="normal"><a href="#__codelineno-33-22">22</a></span>
<span class="normal"><a href="#__codelineno-33-23">23</a></span>
<span class="normal"><a href="#__codelineno-33-24">24</a></span>
<span class="normal"><a href="#__codelineno-33-25">25</a></span>
<span class="normal"><a href="#__codelineno-33-26">26</a></span>
<span class="normal"><a href="#__codelineno-33-27">27</a></span>
<span class="normal"><a href="#__codelineno-33-28">28</a></span>
<span class="normal"><a href="#__codelineno-33-29">29</a></span>
<span class="normal"><a href="#__codelineno-33-30">30</a></span>
<span class="normal"><a href="#__codelineno-33-31">31</a></span>
<span class="normal"><a href="#__codelineno-33-32">32</a></span>
<span class="normal"><a href="#__codelineno-33-33">33</a></span>
<span class="normal"><a href="#__codelineno-33-34">34</a></span>
<span class="normal"><a href="#__codelineno-33-35">35</a></span>
<span class="normal"><a href="#__codelineno-33-36">36</a></span>
<span class="normal"><a href="#__codelineno-33-37">37</a></span>
<span class="normal"><a href="#__codelineno-33-38">38</a></span>
<span class="normal"><a href="#__codelineno-33-39">39</a></span>
<span class="normal"><a href="#__codelineno-33-40">40</a></span>
<span class="normal"><a href="#__codelineno-33-41">41</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1"></a><span class="c1"># This file describes the network interfaces available on your system</span>
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2"></a><span class="c1"># For more information, see netplan(5).</span>
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3"></a><span class="c1"># eno1 - untagged vlan1</span>
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4"></a><span class="c1"># eno1-vlan40 - Vlan interface to connect to tagged vlan40</span>
</span><span id="__span-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5"></a><span class="c1"># eno1-vlan41 - Vlan interface to connect to tagged vlan41</span>
</span><span id="__span-33-6"><a id="__codelineno-33-6" name="__codelineno-33-6"></a><span class="c1"># br0 - bridge for interface eno1 on untagged vlan1</span>
</span><span id="__span-33-7"><a id="__codelineno-33-7" name="__codelineno-33-7"></a><span class="c1"># br40 - bridge tagged on vlan40</span>
</span><span id="__span-33-8"><a id="__codelineno-33-8" name="__codelineno-33-8"></a><span class="c1"># br41 - bridge tagged on vlan41</span>
</span><span id="__span-33-9"><a id="__codelineno-33-9" name="__codelineno-33-9"></a><span class="c1"># switch IPs</span>
</span><span id="__span-33-10"><a id="__codelineno-33-10" name="__codelineno-33-10"></a><span class="c1"># untagged 192.168.10.235</span>
</span><span id="__span-33-11"><a id="__codelineno-33-11" name="__codelineno-33-11"></a><span class="c1"># Vlan 40 192.168.40.235</span>
</span><span id="__span-33-12"><a id="__codelineno-33-12" name="__codelineno-33-12"></a><span class="c1"># Vlan 41 192.168.41.235</span>
</span><span id="__span-33-13"><a id="__codelineno-33-13" name="__codelineno-33-13"></a><span class="nt">network</span><span class="p">:</span>
</span><span id="__span-33-14"><a id="__codelineno-33-14" name="__codelineno-33-14"></a><span class="w">  </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
</span><span id="__span-33-15"><a id="__codelineno-33-15" name="__codelineno-33-15"></a><span class="w">  </span><span class="nt">renderer</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networkd</span>
</span><span id="__span-33-16"><a id="__codelineno-33-16" name="__codelineno-33-16"></a><span class="w">  </span><span class="nt">ethernets</span><span class="p">:</span>
</span><span id="__span-33-17"><a id="__codelineno-33-17" name="__codelineno-33-17"></a><span class="w">    </span><span class="nt">eno1</span><span class="p">:</span>
</span><span id="__span-33-18"><a id="__codelineno-33-18" name="__codelineno-33-18"></a><span class="w">      </span><span class="nt">dhcp4</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</span><span id="__span-33-19"><a id="__codelineno-33-19" name="__codelineno-33-19"></a><span class="w">  </span><span class="nt">vlans</span><span class="p">:</span>
</span><span id="__span-33-20"><a id="__codelineno-33-20" name="__codelineno-33-20"></a><span class="w">    </span><span class="nt">eno1-vlan40</span><span class="p">:</span>
</span><span id="__span-33-21"><a id="__codelineno-33-21" name="__codelineno-33-21"></a><span class="w">      </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">40</span>
</span><span id="__span-33-22"><a id="__codelineno-33-22" name="__codelineno-33-22"></a><span class="w">      </span><span class="nt">link</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eno1</span>
</span><span id="__span-33-23"><a id="__codelineno-33-23" name="__codelineno-33-23"></a><span class="w">    </span><span class="nt">eno1-vlan41</span><span class="p">:</span>
</span><span id="__span-33-24"><a id="__codelineno-33-24" name="__codelineno-33-24"></a><span class="w">      </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">41</span>
</span><span id="__span-33-25"><a id="__codelineno-33-25" name="__codelineno-33-25"></a><span class="w">      </span><span class="nt">link</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eno1</span>
</span><span id="__span-33-26"><a id="__codelineno-33-26" name="__codelineno-33-26"></a><span class="w">    </span><span class="nt">eno1-vlan42</span><span class="p">:</span>
</span><span id="__span-33-27"><a id="__codelineno-33-27" name="__codelineno-33-27"></a><span class="w">      </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">42</span>
</span><span id="__span-33-28"><a id="__codelineno-33-28" name="__codelineno-33-28"></a><span class="w">      </span><span class="nt">link</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">eno1</span>
</span><span id="__span-33-29"><a id="__codelineno-33-29" name="__codelineno-33-29"></a><span class="w">  </span><span class="nt">bridges</span><span class="p">:</span>
</span><span id="__span-33-30"><a id="__codelineno-33-30" name="__codelineno-33-30"></a><span class="w">    </span><span class="nt">br0</span><span class="p">:</span>
</span><span id="__span-33-31"><a id="__codelineno-33-31" name="__codelineno-33-31"></a><span class="w">      </span><span class="nt">interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">eno1</span><span class="p p-Indicator">]</span>
</span><span id="__span-33-32"><a id="__codelineno-33-32" name="__codelineno-33-32"></a><span class="w">      </span><span class="nt">dhcp4</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</span><span id="__span-33-33"><a id="__codelineno-33-33" name="__codelineno-33-33"></a><span class="w">      </span><span class="nt">addresses</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">192.168.10.235/24</span><span class="p p-Indicator">]</span>
</span><span id="__span-33-34"><a id="__codelineno-33-34" name="__codelineno-33-34"></a><span class="w">    </span><span class="nt">br40</span><span class="p">:</span>
</span><span id="__span-33-35"><a id="__codelineno-33-35" name="__codelineno-33-35"></a><span class="w">      </span><span class="nt">interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">eno1-vlan40</span><span class="p p-Indicator">]</span>
</span><span id="__span-33-36"><a id="__codelineno-33-36" name="__codelineno-33-36"></a><span class="w">      </span><span class="nt">dhcp4</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</span><span id="__span-33-37"><a id="__codelineno-33-37" name="__codelineno-33-37"></a><span class="w">      </span><span class="nt">addresses</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">192.168.40.254/24</span><span class="p p-Indicator">]</span>
</span><span id="__span-33-38"><a id="__codelineno-33-38" name="__codelineno-33-38"></a><span class="w">    </span><span class="nt">br41</span><span class="p">:</span>
</span><span id="__span-33-39"><a id="__codelineno-33-39" name="__codelineno-33-39"></a><span class="w">      </span><span class="nt">interfaces</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">eno1-vlan41</span><span class="p p-Indicator">]</span>
</span><span id="__span-33-40"><a id="__codelineno-33-40" name="__codelineno-33-40"></a><span class="w">      </span><span class="nt">dhcp4</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</span><span id="__span-33-41"><a id="__codelineno-33-41" name="__codelineno-33-41"></a><span class="w">      </span><span class="nt">addresses</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">192.168.41.254/24</span><span class="p p-Indicator">]</span>
</span></code></pre></div></td></tr></table></div>
<p>It's very easy to make mistakes when creating a Yaml file. You can use the site <a href="https://jsonformatter.org/yaml-validator">YAML Validator</a> to validate your yaml file.</p>
<h3 id="test-the-new-network-settings">Test the new network settings</h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a>sudo<span class="w"> </span>netplan<span class="w"> </span>try
</span></code></pre></div>
<p>If no errors occur, press <code>enter</code> to accept the network settings.</p>
<h3 id="apply-the-configuration">Apply the configuration</h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>sudo<span class="w"> </span>netplan<span class="w"> </span>apply
</span></code></pre></div>
<h3 id="verify-an-yaml-file-before-modifying-production">Verify an yaml file before modifying production</h3>
<p>The yaml files that Netplan executes can be in these directories:</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-36-1">1</a></span>
<span class="normal"><a href="#__codelineno-36-2">2</a></span>
<span class="normal"><a href="#__codelineno-36-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1"></a>/etc/netplan
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2"></a>/run/netplan
</span><span id="__span-36-3"><a id="__codelineno-36-3" name="__codelineno-36-3"></a>/lib/netplan
</span></code></pre></div></td></tr></table></div>
<p>Netplan searches directories in that order. You can have as many yaml files as needed. They are processed numerically so a file that starts with 00 will be processed first.</p>
<p>You can use the following command to test a yaml file that isn't in one of these locations.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a>sudo<span class="w"> </span>netplan<span class="w"> </span>try<span class="w"> </span>--config-file<span class="w"> </span>/tmp/60-static-ip.yaml
</span></code></pre></div>
<p>Once you are happy with the configuration, copy the configuration file to <code>/etc/netplan/</code> and run <code>sudo netplan apply</code>.</p>
<h3 id="configure-virtual-networks-using-virsh">Configure virtual networks using virsh</h3>
<p>The next step is to configure virtual networks defined for virsh domains. This is not necessary, but it makes VM deployment and management easier.</p>
<h3 id="check-networking-and-delete-the-default-network">Check networking and delete the default network</h3>
<p>Check existing virtual networks:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a>sudo<span class="w"> </span>virsh<span class="w"> </span>net-list<span class="w"> </span>--all
</span></code></pre></div>
<p>There should be one default network as in this example:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a>Name<span class="w">      </span>State<span class="w">    </span>Autostart<span class="w">   </span>Persistent
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a>--------------------------------------------
</span><span id="__span-39-3"><a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a>default<span class="w">   </span>active<span class="w">   </span>yes<span class="w">         </span>yes
</span></code></pre></div>
<p>If needed, use the net-info command to gather more details about the default network:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a>virsh<span class="w"> </span>net-info<span class="w"> </span>default
</span></code></pre></div>
<p>Remove the default network:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a>sudo<span class="w"> </span>virsh<span class="w"> </span>net-destroy<span class="w"> </span>default
</span><span id="__span-41-2"><a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a>sudo<span class="w"> </span>virsh<span class="w"> </span>net-undefine<span class="w"> </span>default
</span></code></pre></div>
<p>Check network list to confirm the changes have been applied. There should no networks defined now:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a>sudo<span class="w"> </span>virsh<span class="w"> </span>net-list<span class="w"> </span>--all
</span></code></pre></div>
<h3 id="create-the-networks">Create the networks</h3>
<p>Create a directory for VM data. For example:</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-43-1">1</a></span>
<span class="normal"><a href="#__codelineno-43-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1"></a>sudo<span class="w"> </span>mkdir<span class="w"> </span>/mnt/vmstore/
</span><span id="__span-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2"></a><span class="nb">cd</span><span class="w"> </span>/mnt/vmstore/
</span></code></pre></div></td></tr></table></div>
<p>Define the bridge interface, br0, for VLAN1 by creating the /mnt/vmstore/net-br0.xml file with the following contents:</p>
<div class="language-xml highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">/mnt/vmstore/net-br0.xml</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-44-1">1</a></span>
<span class="normal"><a href="#__codelineno-44-2">2</a></span>
<span class="normal"><a href="#__codelineno-44-3">3</a></span>
<span class="normal"><a href="#__codelineno-44-4">4</a></span>
<span class="normal"><a href="#__codelineno-44-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1"></a><span class="nt">&lt;network&gt;</span>
</span><span id="__span-44-2"><a id="__codelineno-44-2" name="__codelineno-44-2"></a><span class="w">    </span><span class="nt">&lt;name&gt;</span>br0<span class="nt">&lt;/name&gt;</span>
</span><span id="__span-44-3"><a id="__codelineno-44-3" name="__codelineno-44-3"></a><span class="w">    </span><span class="nt">&lt;forward</span><span class="w"> </span><span class="na">mode=</span><span class="s">&quot;bridge&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</span><span id="__span-44-4"><a id="__codelineno-44-4" name="__codelineno-44-4"></a><span class="w">    </span><span class="nt">&lt;bridge</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;br0&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</span><span id="__span-44-5"><a id="__codelineno-44-5" name="__codelineno-44-5"></a><span class="nt">&lt;/network&gt;</span>
</span></code></pre></div></td></tr></table></div>
<p>Define the bridge interface, br0-vlan40, for VLAN40 by creating the /mnt/vmstore/net-br0-vlan40.xml file with the following contents:</p>
<div class="language-xml highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">/mnt/vmstore/net-br0-vlan40.xml</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-45-1">1</a></span>
<span class="normal"><a href="#__codelineno-45-2">2</a></span>
<span class="normal"><a href="#__codelineno-45-3">3</a></span>
<span class="normal"><a href="#__codelineno-45-4">4</a></span>
<span class="normal"><a href="#__codelineno-45-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1"></a><span class="nt">&lt;network&gt;</span>
</span><span id="__span-45-2"><a id="__codelineno-45-2" name="__codelineno-45-2"></a><span class="w">    </span><span class="nt">&lt;name&gt;</span>br0-vlan40<span class="nt">&lt;/name&gt;</span>
</span><span id="__span-45-3"><a id="__codelineno-45-3" name="__codelineno-45-3"></a><span class="w">    </span><span class="nt">&lt;forward</span><span class="w"> </span><span class="na">mode=</span><span class="s">&quot;bridge&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</span><span id="__span-45-4"><a id="__codelineno-45-4" name="__codelineno-45-4"></a><span class="w">    </span><span class="nt">&lt;bridge</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;br40&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</span><span id="__span-45-5"><a id="__codelineno-45-5" name="__codelineno-45-5"></a><span class="nt">&lt;/network&gt;</span>
</span></code></pre></div></td></tr></table></div>
<p>Define the bridge interface, br0-vlan41, for VLAN41 by creating the /mnt/vmstore/net-br0-vlan41.xml file with the following contents:</p>
<div class="language-xml highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">/mnt/vmstore/net-br0-vlan41.xml</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-46-1">1</a></span>
<span class="normal"><a href="#__codelineno-46-2">2</a></span>
<span class="normal"><a href="#__codelineno-46-3">3</a></span>
<span class="normal"><a href="#__codelineno-46-4">4</a></span>
<span class="normal"><a href="#__codelineno-46-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1"></a><span class="nt">&lt;network&gt;</span>
</span><span id="__span-46-2"><a id="__codelineno-46-2" name="__codelineno-46-2"></a><span class="w">    </span><span class="nt">&lt;name&gt;</span>br0-vlan41<span class="nt">&lt;/name&gt;</span>
</span><span id="__span-46-3"><a id="__codelineno-46-3" name="__codelineno-46-3"></a><span class="w">    </span><span class="nt">&lt;forward</span><span class="w"> </span><span class="na">mode=</span><span class="s">&quot;bridge&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</span><span id="__span-46-4"><a id="__codelineno-46-4" name="__codelineno-46-4"></a><span class="w">    </span><span class="nt">&lt;bridge</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;br41&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</span><span id="__span-46-5"><a id="__codelineno-46-5" name="__codelineno-46-5"></a><span class="nt">&lt;/network&gt;</span>
</span></code></pre></div></td></tr></table></div>
<h3 id="enable-the-networks">Enable the networks</h3>
<p>This consists of three steps (performed for each of the networks):</p>
<ul>
<li>Define the network</li>
<li>Start the network.</li>
<li>Set the network to autostart.</li>
</ul>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-47-1">1</a></span>
<span class="normal"><a href="#__codelineno-47-2">2</a></span>
<span class="normal"><a href="#__codelineno-47-3">3</a></span>
<span class="normal"><a href="#__codelineno-47-4">4</a></span>
<span class="normal"><a href="#__codelineno-47-5">5</a></span>
<span class="normal"><a href="#__codelineno-47-6">6</a></span>
<span class="normal"><a href="#__codelineno-47-7">7</a></span>
<span class="normal"><a href="#__codelineno-47-8">8</a></span>
<span class="normal"><a href="#__codelineno-47-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1"></a>sudo<span class="w"> </span>virsh<span class="w"> </span>net-define<span class="w"> </span>net-br0.xml
</span><span id="__span-47-2"><a id="__codelineno-47-2" name="__codelineno-47-2"></a>sudo<span class="w"> </span>virsh<span class="w"> </span>net-define<span class="w"> </span>net-br0-vlan40.xml
</span><span id="__span-47-3"><a id="__codelineno-47-3" name="__codelineno-47-3"></a>sudo<span class="w"> </span>virsh<span class="w"> </span>net-define<span class="w"> </span>net-br0-vlan41.xml
</span><span id="__span-47-4"><a id="__codelineno-47-4" name="__codelineno-47-4"></a>sudo<span class="w"> </span>virsh<span class="w"> </span>net-start<span class="w"> </span>br0
</span><span id="__span-47-5"><a id="__codelineno-47-5" name="__codelineno-47-5"></a>sudo<span class="w"> </span>virsh<span class="w"> </span>net-start<span class="w"> </span>br0-vlan40
</span><span id="__span-47-6"><a id="__codelineno-47-6" name="__codelineno-47-6"></a>sudo<span class="w"> </span>virsh<span class="w"> </span>net-start<span class="w"> </span>br0-vlan41
</span><span id="__span-47-7"><a id="__codelineno-47-7" name="__codelineno-47-7"></a>sudo<span class="w"> </span>virsh<span class="w"> </span>net-autostart<span class="w"> </span>br0
</span><span id="__span-47-8"><a id="__codelineno-47-8" name="__codelineno-47-8"></a>sudo<span class="w"> </span>virsh<span class="w"> </span>net-autostart<span class="w"> </span>br0-vlan40
</span><span id="__span-47-9"><a id="__codelineno-47-9" name="__codelineno-47-9"></a>sudo<span class="w"> </span>virsh<span class="w"> </span>net-autostart<span class="w"> </span>br0-vlan41
</span></code></pre></div></td></tr></table></div>
<p>At this point you should have a bridge interface configured with the vlans 40, 41 up and running.</p>
<h2 id="verify-the-networks">Verify the networks</h2>
<p>KVM/Virsh provides a rich set of terminal commands for verifying the network and viewing vlans, MAC addresses and ohter network information.</p>
<h3 id="use-net-list">Use net-list</h3>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-48-1">1</a></span>
<span class="normal"><a href="#__codelineno-48-2">2</a></span>
<span class="normal"><a href="#__codelineno-48-3">3</a></span>
<span class="normal"><a href="#__codelineno-48-4">4</a></span>
<span class="normal"><a href="#__codelineno-48-5">5</a></span>
<span class="normal"><a href="#__codelineno-48-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1"></a><span class="hll">sudo<span class="w"> </span>virsh<span class="w"> </span>net-list<span class="w"> </span>--all
</span></span><span id="__span-48-2"><a id="__codelineno-48-2" name="__codelineno-48-2"></a><span class="w"> </span>Name<span class="w">         </span>State<span class="w">    </span>Autostart<span class="w">   </span>Persistent
</span><span id="__span-48-3"><a id="__codelineno-48-3" name="__codelineno-48-3"></a>-----------------------------------------------
</span><span id="__span-48-4"><a id="__codelineno-48-4" name="__codelineno-48-4"></a><span class="w"> </span>br0<span class="w">          </span>active<span class="w">   </span>yes<span class="w">         </span>yes
</span><span id="__span-48-5"><a id="__codelineno-48-5" name="__codelineno-48-5"></a><span class="w"> </span>br0-vlan40<span class="w">   </span>active<span class="w">   </span>yes<span class="w">         </span>yes
</span><span id="__span-48-6"><a id="__codelineno-48-6" name="__codelineno-48-6"></a><span class="w"> </span>br0-vlan41<span class="w">   </span>active<span class="w">   </span>yes<span class="w">         </span>yes
</span></code></pre></div></td></tr></table></div>
<h3 id="viewing-the-links">Viewing the links</h3>
<p>You can use the following command to view the links. I have piped the output to <code>grep</code> and used the <code>or</code> operator <code>\|</code> to filter on <code>master</code> and <code>vlan protocol</code>.</p>
<p>Untagged br0</p>
<div class="language-yaml highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-49-1">1</a></span>
<span class="normal"><a href="#__codelineno-49-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-49-1"><a id="__codelineno-49-1" name="__codelineno-49-1"></a><span class="hll"><span class="l l-Scalar l-Scalar-Plain">ip -d link show dev eno1  | grep &#39;master \| vlan protocol&#39;</span>
</span></span><span id="__span-49-2"><a id="__codelineno-49-2" name="__codelineno-49-2"></a><span class="l l-Scalar l-Scalar-Plain">4</span><span class="nt">: eno1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">&lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast master br0 state UP mode DEFAULT group default qlen 1000</span>
</span></code></pre></div></td></tr></table></div>
<p>Tagged vlan 40</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-50-1">1</a></span>
<span class="normal"><a href="#__codelineno-50-2">2</a></span>
<span class="normal"><a href="#__codelineno-50-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-50-1"><a id="__codelineno-50-1" name="__codelineno-50-1"></a><span class="hll">ip<span class="w"> </span>-d<span class="w"> </span>link<span class="w"> </span>show<span class="w"> </span>dev<span class="w"> </span>eno1-vlan40<span class="w">  </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s1">&#39;master \| vlan protocol&#39;</span>
</span></span><span id="__span-50-2"><a id="__codelineno-50-2" name="__codelineno-50-2"></a><span class="m">137</span>:<span class="w"> </span>eno1-vlan40@eno1:<span class="w"> </span>&lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt;<span class="w"> </span>mtu<span class="w"> </span><span class="m">1500</span><span class="w"> </span>qdisc<span class="w"> </span>noqueue<span class="w"> </span>master<span class="w"> </span>br40<span class="w"> </span>state<span class="w"> </span>UP<span class="w"> </span>mode<span class="w"> </span>DEFAULT<span class="w"> </span>group<span class="w"> </span>default<span class="w"> </span>qlen<span class="w"> </span><span class="m">1000</span>
</span><span id="__span-50-3"><a id="__codelineno-50-3" name="__codelineno-50-3"></a><span class="w">    </span>vlan<span class="w"> </span>protocol<span class="w"> </span><span class="m">802</span>.1Q<span class="w"> </span>id<span class="w"> </span><span class="m">40</span><span class="w"> </span>&lt;REORDER_HDR&gt;
</span></code></pre></div></td></tr></table></div>
<div class="admonition note">
<p class="admonition-title">See what bridge the vlan interface is connected to</p>
<p>The <code>master br40</code> in line 2 tells you that this interface is <strong>mastered</strong> to bridge br40. Line 3 shows the vlan tagging is <code>id 40</code> or vlan 40.</p>
</div>
<p>Tagged vlan 41</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-51-1">1</a></span>
<span class="normal"><a href="#__codelineno-51-2">2</a></span>
<span class="normal"><a href="#__codelineno-51-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-51-1"><a id="__codelineno-51-1" name="__codelineno-51-1"></a><span class="hll">ip<span class="w"> </span>-d<span class="w"> </span>link<span class="w"> </span>show<span class="w"> </span>dev<span class="w"> </span>eno1-vlan41<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s1">&#39;master \| vlan protocol&#39;</span>
</span></span><span id="__span-51-2"><a id="__codelineno-51-2" name="__codelineno-51-2"></a><span class="m">84</span>:<span class="w"> </span>eno1-vlan41@eno1:<span class="w"> </span>&lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt;<span class="w"> </span>mtu<span class="w"> </span><span class="m">1500</span><span class="w"> </span>qdisc<span class="w"> </span>noqueue<span class="w"> </span>master<span class="w"> </span>br41<span class="w"> </span>state<span class="w"> </span>UP<span class="w"> </span>mode<span class="w"> </span>DEFAULT<span class="w"> </span>group<span class="w"> </span>default<span class="w"> </span>qlen<span class="w"> </span><span class="m">1000</span>
</span><span id="__span-51-3"><a id="__codelineno-51-3" name="__codelineno-51-3"></a><span class="w">    </span>vlan<span class="w"> </span>protocol<span class="w"> </span><span class="m">802</span>.1Q<span class="w"> </span>id<span class="w"> </span><span class="m">41</span><span class="w"> </span>&lt;REORDER_HDR&gt;
</span></code></pre></div></td></tr></table></div>
<div class="admonition note">
<p class="admonition-title">See what bridge the vlan interface is connected to</p>
<p>The <code>master br41</code> in line 2 tells you that this interface is <strong>mastered</strong> to bridge br41. Line 3 shows the vlan tagging is <code>id 41</code> or vlan 41.</p>
</div>
<h3 id="display-the-bridge-interfaces">Display the bridge interfaces</h3>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-52-1">1</a></span>
<span class="normal"><a href="#__codelineno-52-2">2</a></span>
<span class="normal"><a href="#__codelineno-52-3">3</a></span>
<span class="normal"><a href="#__codelineno-52-4">4</a></span>
<span class="normal"><a href="#__codelineno-52-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-52-1"><a id="__codelineno-52-1" name="__codelineno-52-1"></a><span class="hll">sudo<span class="w"> </span>bridge<span class="w"> </span>link
</span></span><span id="__span-52-2"><a id="__codelineno-52-2" name="__codelineno-52-2"></a><span class="m">4</span>:<span class="w"> </span>eno1:<span class="w"> </span>&lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt;<span class="w"> </span>mtu<span class="w"> </span><span class="m">1500</span><span class="w"> </span>master<span class="w"> </span>br0<span class="w"> </span>state<span class="w"> </span>forwarding<span class="w"> </span>priority<span class="w"> </span><span class="m">32</span><span class="w"> </span>cost<span class="w"> </span><span class="m">100</span>
</span><span id="__span-52-3"><a id="__codelineno-52-3" name="__codelineno-52-3"></a><span class="m">75</span>:<span class="w"> </span>vnet18:<span class="w"> </span>&lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt;<span class="w"> </span>mtu<span class="w"> </span><span class="m">1500</span><span class="w"> </span>master<span class="w"> </span>br40<span class="w"> </span>state<span class="w"> </span>forwarding<span class="w"> </span>priority<span class="w"> </span><span class="m">32</span><span class="w"> </span>cost<span class="w"> </span><span class="m">2</span>
</span><span id="__span-52-4"><a id="__codelineno-52-4" name="__codelineno-52-4"></a><span class="m">149</span>:<span class="w"> </span>eno1-vlan40@eno1:<span class="w"> </span>&lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt;<span class="w"> </span>mtu<span class="w"> </span><span class="m">1500</span><span class="w"> </span>master<span class="w"> </span>br40<span class="w"> </span>state<span class="w"> </span>forwarding<span class="w"> </span>priority<span class="w"> </span><span class="m">32</span><span class="w"> </span>cost<span class="w"> </span><span class="m">100</span>
</span><span id="__span-52-5"><a id="__codelineno-52-5" name="__codelineno-52-5"></a><span class="m">150</span>:<span class="w"> </span>eno1-vlan41@eno1:<span class="w"> </span>&lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt;<span class="w"> </span>mtu<span class="w"> </span><span class="m">1500</span><span class="w"> </span>master<span class="w"> </span>br41<span class="w"> </span>state<span class="w"> </span>forwarding<span class="w"> </span>priority<span class="w"> </span><span class="m">32</span><span class="w"> </span>cost<span class="w"> </span><span class="m">100</span>
</span></code></pre></div></td></tr></table></div>
<p><img alt="➡" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/27a1.svg" title=":arrow_right:" />  This output is after I connected the Ubuntu VM to <code>br0-vlan40</code>. That is why there is the <code>vnet18</code>entry. The <code>vnet</code> is the virtual interface in the VM.</p>
<p>You can add at <code>-d</code> flag for more details:</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-53-1">1</a></span>
<span class="normal"><a href="#__codelineno-53-2">2</a></span>
<span class="normal"><a href="#__codelineno-53-3">3</a></span>
<span class="normal"><a href="#__codelineno-53-4">4</a></span>
<span class="normal"><a href="#__codelineno-53-5">5</a></span>
<span class="normal"><a href="#__codelineno-53-6">6</a></span>
<span class="normal"><a href="#__codelineno-53-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-53-1"><a id="__codelineno-53-1" name="__codelineno-53-1"></a><span class="hll">sudo<span class="w"> </span>bridge<span class="w"> </span>-d<span class="w"> </span>link
</span></span><span id="__span-53-2"><a id="__codelineno-53-2" name="__codelineno-53-2"></a><span class="m">4</span>:<span class="w"> </span>eno1:<span class="w"> </span>&lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt;<span class="w"> </span>mtu<span class="w"> </span><span class="m">1500</span><span class="w"> </span>master<span class="w"> </span>br0<span class="w"> </span>state<span class="w"> </span>forwarding<span class="w"> </span>priority<span class="w"> </span><span class="m">32</span><span class="w"> </span>cost<span class="w"> </span><span class="m">100</span>
</span><span id="__span-53-3"><a id="__codelineno-53-3" name="__codelineno-53-3"></a><span class="w">    </span>hairpin<span class="w"> </span>off<span class="w"> </span>guard<span class="w"> </span>off<span class="w"> </span>root_block<span class="w"> </span>off<span class="w"> </span>fastleave<span class="w"> </span>off<span class="w"> </span>learning<span class="w"> </span>on<span class="w"> </span>flood<span class="w"> </span>on<span class="w"> </span>mcast_flood<span class="w"> </span>on<span class="w"> </span>bcast_flood<span class="w"> </span>on<span class="w"> </span>mcast_router<span class="w"> </span><span class="m">1</span><span class="w"> </span>mcast_to_unicast<span class="w"> </span>off<span class="w"> </span>neigh_suppress<span class="w"> </span>off<span class="w"> </span>Vlan_tunnel<span class="w"> </span>off<span class="w"> </span>isolated<span class="w"> </span>off<span class="w"> </span>locked<span class="w"> </span>off
</span><span id="__span-53-4"><a id="__codelineno-53-4" name="__codelineno-53-4"></a><span class="m">83</span>:<span class="w"> </span>eno1-vlan40@eno1:<span class="w"> </span>&lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt;<span class="w"> </span>mtu<span class="w"> </span><span class="m">1500</span><span class="w"> </span>master<span class="w"> </span>br40<span class="w"> </span>state<span class="w"> </span>forwarding<span class="w"> </span>priority<span class="w"> </span><span class="m">32</span><span class="w"> </span>cost<span class="w"> </span><span class="m">100</span>
</span><span id="__span-53-5"><a id="__codelineno-53-5" name="__codelineno-53-5"></a><span class="w">    </span>hairpin<span class="w"> </span>off<span class="w"> </span>guard<span class="w"> </span>off<span class="w"> </span>root_block<span class="w"> </span>off<span class="w"> </span>fastleave<span class="w"> </span>off<span class="w"> </span>learning<span class="w"> </span>on<span class="w"> </span>flood<span class="w"> </span>on<span class="w"> </span>mcast_flood<span class="w"> </span>on<span class="w"> </span>bcast_flood<span class="w"> </span>on<span class="w"> </span>mcast_router<span class="w"> </span><span class="m">1</span><span class="w"> </span>mcast_to_unicast<span class="w"> </span>off<span class="w"> </span>neigh_suppress<span class="w"> </span>off<span class="w"> </span>Vlan_tunnel<span class="w"> </span>off<span class="w"> </span>isolated<span class="w"> </span>off<span class="w"> </span>locked<span class="w"> </span>off
</span><span id="__span-53-6"><a id="__codelineno-53-6" name="__codelineno-53-6"></a><span class="m">84</span>:<span class="w"> </span>eno1-vlan41@eno1:<span class="w"> </span>&lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt;<span class="w"> </span>mtu<span class="w"> </span><span class="m">1500</span><span class="w"> </span>master<span class="w"> </span>br41<span class="w"> </span>state<span class="w"> </span>forwarding<span class="w"> </span>priority<span class="w"> </span><span class="m">32</span><span class="w"> </span>cost<span class="w"> </span><span class="m">100</span>
</span><span id="__span-53-7"><a id="__codelineno-53-7" name="__codelineno-53-7"></a><span class="w">    </span>hairpin<span class="w"> </span>off<span class="w"> </span>guard<span class="w"> </span>off<span class="w"> </span>root_block<span class="w"> </span>off<span class="w"> </span>fastleave<span class="w"> </span>off<span class="w"> </span>learning<span class="w"> </span>on<span class="w"> </span>flood<span class="w"> </span>on<span class="w"> </span>mcast_flood<span class="w"> </span>on<span class="w"> </span>bcast_flood<span class="w"> </span>on<span class="w"> </span>mcast_router<span class="w"> </span><span class="m">1</span><span class="w"> </span>mcast_to_unicast<span class="w"> </span>off<span class="w"> </span>neigh_suppress<span class="w"> </span>off<span class="w"> </span>Vlan_tunnel<span class="w"> </span>off<span class="w"> </span>isolated<span class="w"> </span>off<span class="w"> </span>locked<span class="w"> </span>off
</span></code></pre></div></td></tr></table></div>
<h3 id="display-the-ipv6-multicast-groups">Display the ipv6 multicast groups</h3>
<p>I have ipv6 running on br0. To view the ipv6 multicast groups that it has joined:</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-54-1">1</a></span>
<span class="normal"><a href="#__codelineno-54-2">2</a></span>
<span class="normal"><a href="#__codelineno-54-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-54-1"><a id="__codelineno-54-1" name="__codelineno-54-1"></a><span class="hll">sudo<span class="w"> </span>bridge<span class="w"> </span>-d<span class="w"> </span>mdb
</span></span><span id="__span-54-2"><a id="__codelineno-54-2" name="__codelineno-54-2"></a>dev<span class="w"> </span>br0<span class="w"> </span>port<span class="w"> </span>eno1<span class="w"> </span>grp<span class="w"> </span>ff02::1:ffe0:a4db<span class="w"> </span>temp<span class="w"> </span>proto<span class="w"> </span>kernel
</span><span id="__span-54-3"><a id="__codelineno-54-3" name="__codelineno-54-3"></a>dev<span class="w"> </span>br0<span class="w"> </span>port<span class="w"> </span>eno1<span class="w"> </span>grp<span class="w"> </span>ff02::fb<span class="w"> </span>temp<span class="w"> </span>proto<span class="w"> </span>kernel
</span></code></pre></div></td></tr></table></div>
<h3 id="monitor-devices">Monitor devices</h3>
<p>From the <code>man bridge</code> page</p>
<p>The bridge utility can monitor the state of devices and addresses continuously This option has a slightly different format. Namely, the monitor command is the first in the command line and then the object list follows:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-55-1"><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a>     bridge monitor [ all | OBJECT-LIST ]
</span><span id="__span-55-2"><a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a>
</span><span id="__span-55-3"><a id="__codelineno-55-3" name="__codelineno-55-3" href="#__codelineno-55-3"></a>     OBJECT-LIST is the list of object types that we want to monitor.
</span><span id="__span-55-4"><a id="__codelineno-55-4" name="__codelineno-55-4" href="#__codelineno-55-4"></a>     It may contain link, fdb, vlan and mdb.  If no file argument is
</span><span id="__span-55-5"><a id="__codelineno-55-5" name="__codelineno-55-5" href="#__codelineno-55-5"></a>     given, bridge opens RTNETLINK, listens on it and dumps state
</span><span id="__span-55-6"><a id="__codelineno-55-6" name="__codelineno-55-6" href="#__codelineno-55-6"></a>     changes in the format described in previous sections.
</span><span id="__span-55-7"><a id="__codelineno-55-7" name="__codelineno-55-7" href="#__codelineno-55-7"></a>
</span><span id="__span-55-8"><a id="__codelineno-55-8" name="__codelineno-55-8" href="#__codelineno-55-8"></a>     If a file name is given, it does not listen on RTNETLINK, but
</span><span id="__span-55-9"><a id="__codelineno-55-9" name="__codelineno-55-9" href="#__codelineno-55-9"></a>     opens the file containing RTNETLINK messages saved in binary
</span><span id="__span-55-10"><a id="__codelineno-55-10" name="__codelineno-55-10" href="#__codelineno-55-10"></a>     format and dumps them.
</span></code></pre></div>
<p>With no object given:</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-56-1">1</a></span>
<span class="normal"><a href="#__codelineno-56-2">2</a></span>
<span class="normal"><a href="#__codelineno-56-3">3</a></span>
<span class="normal"><a href="#__codelineno-56-4">4</a></span>
<span class="normal"><a href="#__codelineno-56-5">5</a></span>
<span class="normal"><a href="#__codelineno-56-6">6</a></span>
<span class="normal"><a href="#__codelineno-56-7">7</a></span>
<span class="normal"><a href="#__codelineno-56-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-56-1"><a id="__codelineno-56-1" name="__codelineno-56-1"></a><span class="hll">sudo<span class="w"> </span>bridge<span class="w"> </span>-d<span class="w"> </span>monitor
</span></span><span id="__span-56-2"><a id="__codelineno-56-2" name="__codelineno-56-2"></a>Deleted<span class="w"> </span>dc:cd:2f:3c:85:57<span class="w"> </span>dev<span class="w"> </span>eno1<span class="w"> </span>master<span class="w"> </span>br0<span class="w"> </span>stale
</span><span id="__span-56-3"><a id="__codelineno-56-3" name="__codelineno-56-3"></a>Deleted<span class="w"> </span><span class="m">00</span>:e0:b3:34:56:2f<span class="w"> </span>dev<span class="w"> </span>eno1<span class="w"> </span>master<span class="w"> </span>br0<span class="w"> </span>stale
</span><span id="__span-56-4"><a id="__codelineno-56-4" name="__codelineno-56-4"></a>Deleted<span class="w"> </span>d8:d4:3c:65:1b:3e<span class="w"> </span>dev<span class="w"> </span>eno1<span class="w"> </span>master<span class="w"> </span>br0<span class="w"> </span>stale
</span><span id="__span-56-5"><a id="__codelineno-56-5" name="__codelineno-56-5"></a><span class="m">00</span>:e0:b3:34:56:2f<span class="w"> </span>dev<span class="w"> </span>eno1<span class="w"> </span>master<span class="w"> </span>br0
</span><span id="__span-56-6"><a id="__codelineno-56-6" name="__codelineno-56-6"></a>Deleted<span class="w"> </span><span class="m">06</span>:8b:73:5b:10:e7<span class="w"> </span>dev<span class="w"> </span>eno1<span class="w"> </span>master<span class="w"> </span>br0<span class="w"> </span>stale
</span><span id="__span-56-7"><a id="__codelineno-56-7" name="__codelineno-56-7"></a>Deleted<span class="w"> </span>dev<span class="w"> </span>br0<span class="w"> </span>port<span class="w"> </span>eno1<span class="w"> </span>grp<span class="w"> </span>ff02::fb<span class="w"> </span>temp<span class="w"> </span>proto<span class="w"> </span>kernel
</span><span id="__span-56-8"><a id="__codelineno-56-8" name="__codelineno-56-8"></a>dev<span class="w"> </span>br0<span class="w"> </span>port<span class="w"> </span>eno1<span class="w"> </span>grp<span class="w"> </span>ff02::fb<span class="w"> </span>temp<span class="w"> </span>proto<span class="w"> </span>kernel
</span></code></pre></div></td></tr></table></div>
<h3 id="attach-a-vm-to-vlan-40">Attach a VM to vlan 40</h3>
<p>In virt-manager, double click on a VM, select View, Details. Click on NIC on the left and then select `Virtual network 'br0-vlan40' from the dropdown list. Click apply to save the configuration.</p>
<p><img alt="screenshot" src="../img/BR40-VM-Interface.png" /></p>
<p>Click view, console to open the Ubuntu VM. I don't have a DHCP server on vlan 40 so I manually set <code>192.168.40.200</code> as the address.</p>
<p>From the terminal on the VM run <code>ip address</code> to find the MAC address.</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-57-1">1</a></span>
<span class="normal"><a href="#__codelineno-57-2">2</a></span>
<span class="normal"><a href="#__codelineno-57-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-57-1"><a id="__codelineno-57-1" name="__codelineno-57-1"></a><span class="m">2</span>:<span class="w"> </span>enp8s0:<span class="w"> </span>&lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt;<span class="w"> </span>mtu<span class="w"> </span><span class="m">1500</span><span class="w"> </span>qdisc<span class="w"> </span>pfifo_fast<span class="w"> </span>state<span class="w"> </span>UP<span class="w"> </span>group<span class="w"> </span>default<span class="w"> </span>qlen<span class="w"> </span><span class="m">1000</span>
</span><span id="__span-57-2"><a id="__codelineno-57-2" name="__codelineno-57-2"></a><span class="w">    </span>link/ether<span class="w"> </span><span class="m">52</span>:54:00:75:21:34<span class="w"> </span>brd<span class="w"> </span>ff:ff:ff:ff:ff:ff
</span><span id="__span-57-3"><a id="__codelineno-57-3" name="__codelineno-57-3"></a><span class="w">    </span>inet<span class="w"> </span><span class="m">192</span>.168.40.200/24<span class="w"> </span>brd<span class="w"> </span><span class="m">192</span>.168.40.255<span class="w"> </span>scope<span class="w"> </span>global<span class="w"> </span>noprefixroute<span class="w"> </span>enp8s0
</span></code></pre></div></td></tr></table></div>
<p>Now back on the host run</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-58-1">1</a></span>
<span class="normal"><a href="#__codelineno-58-2">2</a></span>
<span class="normal"><a href="#__codelineno-58-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-58-1"><a id="__codelineno-58-1" name="__codelineno-58-1"></a><span class="hll">ip<span class="w"> </span>a<span class="w"> </span>show<span class="w"> </span>dev<span class="w"> </span>eno1-vlan40
</span></span><span id="__span-58-2"><a id="__codelineno-58-2" name="__codelineno-58-2"></a><span class="m">149</span>:<span class="w"> </span>eno1-vlan40@eno1:<span class="w"> </span>&lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt;<span class="w"> </span>mtu<span class="w"> </span><span class="m">1500</span><span class="w"> </span>qdisc<span class="w"> </span>noqueue<span class="w"> </span>master<span class="w"> </span>br40<span class="w"> </span>state<span class="w"> </span>UP<span class="w"> </span>group<span class="w"> </span>default<span class="w"> </span>qlen<span class="w"> </span><span class="m">1000</span>
</span><span id="__span-58-3"><a id="__codelineno-58-3" name="__codelineno-58-3"></a><span class="w">    </span>link/ether<span class="w"> </span>c4:34:6b:65:b6:d0<span class="w"> </span>brd<span class="w"> </span>ff:ff:ff:ff:ff:ff
</span></code></pre></div></td></tr></table></div>
<p>The vlan 40 interface has a MAC address of <code>c4:34:6b:65:b6:d0</code></p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-59-1">1</a></span>
<span class="normal"><a href="#__codelineno-59-2">2</a></span>
<span class="normal"><a href="#__codelineno-59-3">3</a></span>
<span class="normal"><a href="#__codelineno-59-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-59-1"><a id="__codelineno-59-1" name="__codelineno-59-1"></a><span class="hll">brctl showmacs br40
</span></span><span id="__span-59-2"><a id="__codelineno-59-2" name="__codelineno-59-2"></a>port no  mac addr           is local?  ageing timer
</span><span id="__span-59-3"><a id="__codelineno-59-3" name="__codelineno-59-3"></a> 1   c4:34:6b:65:b6:d0      yes           0.00
</span><span id="__span-59-4"><a id="__codelineno-59-4" name="__codelineno-59-4"></a> 2   52:54:00:75:21:34      no            0.29
</span></code></pre></div></td></tr></table></div>
<p>The Ubuntu VM's MAC and the vlan 40 mac are on the bridge <code>br40</code>!</p>
<p>On the Cisco switch:</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-60-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-60-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-60-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-60-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-60-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-60-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-60-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-60-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-60-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-60-10">10</a></span>
<span class="normal"><a href="#__codelineno-60-11">11</a></span>
<span class="normal"><a href="#__codelineno-60-12">12</a></span>
<span class="normal"><a href="#__codelineno-60-13">13</a></span>
<span class="normal"><a href="#__codelineno-60-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-60-1"><a id="__codelineno-60-1" name="__codelineno-60-1"></a><span class="hll">show mac address-table interface Gi1/0/6
</span></span><span id="__span-60-2"><a id="__codelineno-60-2" name="__codelineno-60-2"></a>          Mac Address Table
</span><span id="__span-60-3"><a id="__codelineno-60-3" name="__codelineno-60-3"></a>-------------------------------------------
</span><span id="__span-60-4"><a id="__codelineno-60-4" name="__codelineno-60-4"></a>
</span><span id="__span-60-5"><a id="__codelineno-60-5" name="__codelineno-60-5"></a>Vlan    Mac Address       Type        Ports
</span><span id="__span-60-6"><a id="__codelineno-60-6" name="__codelineno-60-6"></a>----    -----------       --------    -----
</span><span id="__span-60-7"><a id="__codelineno-60-7" name="__codelineno-60-7"></a>  10    c434.6b65.b6d0    DYNAMIC     Gi1/0/6
</span><span id="__span-60-8"><a id="__codelineno-60-8" name="__codelineno-60-8"></a>  10    e6b5.f8a0.9bc5    DYNAMIC     Gi1/0/6
</span><span id="__span-60-9"><a id="__codelineno-60-9" name="__codelineno-60-9"></a><span class="hll">  40    7e3a.69b5.0656    DYNAMIC     Gi1/0/6
</span></span><span id="__span-60-10"><a id="__codelineno-60-10" name="__codelineno-60-10"></a>  40    c434.6b65.b6d0    DYNAMIC     Gi1/0/6
</span><span id="__span-60-11"><a id="__codelineno-60-11" name="__codelineno-60-11"></a><span class="hll">  40    5254.0075.2134    DYNAMIC     Gi1/0/6
</span></span><span id="__span-60-12"><a id="__codelineno-60-12" name="__codelineno-60-12"></a>  41    6622.e1b0.951b    DYNAMIC     Gi1/0/6
</span><span id="__span-60-13"><a id="__codelineno-60-13" name="__codelineno-60-13"></a>  41    c434.6b65.b6d0    DYNAMIC     Gi1/0/6
</span><span id="__span-60-14"><a id="__codelineno-60-14" name="__codelineno-60-14"></a>Total Mac Addresses for this criterion: 7
</span></code></pre></div></td></tr></table></div>
<p>You can see the <code>br40</code> MAC address on line 9 and the VM's MAC address on line 11. So we have verified that the bridge works and the vlan tagging works!</p>
<h3 id="traceroute-to-vlan-10">traceroute to vlan 10</h3>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-61-1">1</a></span>
<span class="normal"><a href="#__codelineno-61-2">2</a></span>
<span class="normal"><a href="#__codelineno-61-3">3</a></span>
<span class="normal"><a href="#__codelineno-61-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-61-1"><a id="__codelineno-61-1" name="__codelineno-61-1"></a><span class="hll">traceroute<span class="w"> </span><span class="m">192</span>.168.10.222
</span></span><span id="__span-61-2"><a id="__codelineno-61-2" name="__codelineno-61-2"></a>traceroute<span class="w"> </span>to<span class="w"> </span><span class="m">192</span>.168.10.222<span class="w"> </span><span class="o">(</span><span class="m">192</span>.168.10.222<span class="o">)</span>,<span class="w"> </span><span class="m">64</span><span class="w"> </span>hops<span class="w"> </span>max
</span><span id="__span-61-3"><a id="__codelineno-61-3" name="__codelineno-61-3"></a><span class="w">  </span><span class="m">1</span><span class="w">   </span><span class="m">192</span>.168.40.235<span class="w">  </span><span class="m">3</span>.288ms<span class="w">  </span><span class="m">1</span>.321ms<span class="w">  </span><span class="m">1</span>.186ms
</span><span id="__span-61-4"><a id="__codelineno-61-4" name="__codelineno-61-4"></a><span class="w">  </span><span class="m">2</span><span class="w">   </span><span class="m">192</span>.168.10.222<span class="w">  </span><span class="m">0</span>.373ms<span class="w">  </span><span class="m">0</span>.400ms<span class="w">  </span><span class="m">1</span>.894ms
</span></code></pre></div></td></tr></table></div>
<p>The route hit interface vlan 40 on the switch and then the inter vlan routing sent it to the device at 192.168.10.222.</p>
<p>It looks like we have successfully created a bridged interface with 3 vlans.</p>
<h3 id="brctl-options">brctl options</h3>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-62-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-62-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-62-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-62-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-62-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-62-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-62-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-62-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-62-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-62-10">10</a></span>
<span class="normal"><a href="#__codelineno-62-11">11</a></span>
<span class="normal"><a href="#__codelineno-62-12">12</a></span>
<span class="normal"><a href="#__codelineno-62-13">13</a></span>
<span class="normal"><a href="#__codelineno-62-14">14</a></span>
<span class="normal"><a href="#__codelineno-62-15">15</a></span>
<span class="normal"><a href="#__codelineno-62-16">16</a></span>
<span class="normal"><a href="#__codelineno-62-17">17</a></span>
<span class="normal"><a href="#__codelineno-62-18">18</a></span>
<span class="normal"><a href="#__codelineno-62-19">19</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-62-1"><a id="__codelineno-62-1" name="__codelineno-62-1"></a><span class="hll">sudo<span class="w"> </span>brctl
</span></span><span id="__span-62-2"><a id="__codelineno-62-2" name="__codelineno-62-2"></a>Usage:<span class="w"> </span>brctl<span class="w"> </span><span class="o">[</span>commands<span class="o">]</span>
</span><span id="__span-62-3"><a id="__codelineno-62-3" name="__codelineno-62-3"></a>commands:
</span><span id="__span-62-4"><a id="__codelineno-62-4" name="__codelineno-62-4"></a><span class="w">    </span>addbr<span class="w">          </span>&lt;bridge&gt;<span class="w">                 </span>add<span class="w"> </span>bridge
</span><span id="__span-62-5"><a id="__codelineno-62-5" name="__codelineno-62-5"></a><span class="w">    </span>delbr<span class="w">          </span>&lt;bridge&gt;<span class="w">                 </span>delete<span class="w"> </span>bridge
</span><span id="__span-62-6"><a id="__codelineno-62-6" name="__codelineno-62-6"></a><span class="w">    </span>addif<span class="w">          </span>&lt;bridge&gt;<span class="w"> </span>&lt;device&gt;<span class="w">        </span>add<span class="w"> </span>interface<span class="w"> </span>to<span class="w"> </span>bridge
</span><span id="__span-62-7"><a id="__codelineno-62-7" name="__codelineno-62-7"></a><span class="w">    </span>delif<span class="w">          </span>&lt;bridge&gt;<span class="w"> </span>&lt;device&gt;<span class="w">        </span>delete<span class="w"> </span>interface<span class="w"> </span>from<span class="w"> </span>bridge
</span><span id="__span-62-8"><a id="__codelineno-62-8" name="__codelineno-62-8"></a><span class="w">    </span>hairpin<span class="w">        </span>&lt;bridge&gt;<span class="w"> </span>&lt;port&gt;<span class="w"> </span><span class="o">{</span>on<span class="p">|</span>off<span class="o">}</span><span class="w"> </span>turn<span class="w"> </span>hairpin<span class="w"> </span>on/off
</span><span id="__span-62-9"><a id="__codelineno-62-9" name="__codelineno-62-9"></a><span class="w">    </span>setageing<span class="w">      </span>&lt;bridge&gt;<span class="w"> </span>&lt;time&gt;<span class="w">          </span><span class="nb">set</span><span class="w"> </span>ageing<span class="w"> </span><span class="nb">time</span>
</span><span id="__span-62-10"><a id="__codelineno-62-10" name="__codelineno-62-10"></a><span class="w">    </span>setbridgeprio<span class="w">  </span>&lt;bridge&gt;<span class="w"> </span>&lt;prio&gt;<span class="w">          </span><span class="nb">set</span><span class="w"> </span>bridge<span class="w"> </span>priority
</span><span id="__span-62-11"><a id="__codelineno-62-11" name="__codelineno-62-11"></a><span class="w">    </span>setfd<span class="w">          </span>&lt;bridge&gt;<span class="w"> </span>&lt;time&gt;<span class="w">          </span><span class="nb">set</span><span class="w"> </span>bridge<span class="w"> </span>forward<span class="w"> </span>delay
</span><span id="__span-62-12"><a id="__codelineno-62-12" name="__codelineno-62-12"></a><span class="w">    </span>sethello<span class="w">       </span>&lt;bridge&gt;<span class="w"> </span>&lt;time&gt;<span class="w">          </span><span class="nb">set</span><span class="w"> </span>hello<span class="w"> </span><span class="nb">time</span>
</span><span id="__span-62-13"><a id="__codelineno-62-13" name="__codelineno-62-13"></a><span class="w">    </span>setmaxage<span class="w">      </span>&lt;bridge&gt;<span class="w"> </span>&lt;time&gt;<span class="w">          </span><span class="nb">set</span><span class="w"> </span>max<span class="w"> </span>message<span class="w"> </span>age
</span><span id="__span-62-14"><a id="__codelineno-62-14" name="__codelineno-62-14"></a><span class="w">    </span>setpathcost<span class="w">    </span>&lt;bridge&gt;<span class="w"> </span>&lt;port&gt;<span class="w"> </span>&lt;cost&gt;<span class="w">   </span><span class="nb">set</span><span class="w"> </span>path<span class="w"> </span>cost
</span><span id="__span-62-15"><a id="__codelineno-62-15" name="__codelineno-62-15"></a><span class="w">    </span>setportprio<span class="w">    </span>&lt;bridge&gt;<span class="w"> </span>&lt;port&gt;<span class="w"> </span>&lt;prio&gt;<span class="w">   </span><span class="nb">set</span><span class="w"> </span>port<span class="w"> </span>priority
</span><span id="__span-62-16"><a id="__codelineno-62-16" name="__codelineno-62-16"></a><span class="w">    </span>show<span class="w">           </span><span class="o">[</span><span class="w"> </span>&lt;bridge&gt;<span class="w"> </span><span class="o">]</span><span class="w">             </span>show<span class="w"> </span>a<span class="w"> </span>list<span class="w"> </span>of<span class="w"> </span>bridges
</span><span id="__span-62-17"><a id="__codelineno-62-17" name="__codelineno-62-17"></a><span class="w">    </span>showmacs<span class="w">       </span>&lt;bridge&gt;<span class="w">                 </span>show<span class="w"> </span>a<span class="w"> </span>list<span class="w"> </span>of<span class="w"> </span>mac<span class="w"> </span>addrs
</span><span id="__span-62-18"><a id="__codelineno-62-18" name="__codelineno-62-18"></a><span class="w">    </span>showstp<span class="w">        </span>&lt;bridge&gt;<span class="w">                 </span>show<span class="w"> </span>bridge<span class="w"> </span>stp<span class="w"> </span>info
</span><span id="__span-62-19"><a id="__codelineno-62-19" name="__codelineno-62-19"></a><span class="w">    </span>stp<span class="w">            </span>&lt;bridge&gt;<span class="w"> </span><span class="o">{</span>on<span class="p">|</span>off<span class="o">}</span><span class="w">        </span>turn<span class="w"> </span>stp<span class="w"> </span>on/off
</span></code></pre></div></td></tr></table></div>
<h2 id="networkmanager-debug-logs">NetworkManager debug logs</h2>
<p>By default, the NetworkManager log level is set to info. You can use nmcli to modify the logging level:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-63-1"><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a>sudo<span class="w"> </span>nmcli<span class="w"> </span>general<span class="w"> </span>logging<span class="w"> </span>level<span class="w"> </span>DEBUG<span class="w"> </span>domains<span class="w"> </span>ALL
</span></code></pre></div>
<p>You do not need to restart NetworkManager to begin seeing debug messages logged to journalctl. You can watch the NetworkManager logs:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-64-1"><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a>sudo<span class="w"> </span>journalctl<span class="w"> </span>-f<span class="w"> </span>-u<span class="w"> </span>NetworkManager
</span></code></pre></div>
<h3 id="set-logging-back-to-info">Set logging back to info</h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-65-1"><a id="__codelineno-65-1" name="__codelineno-65-1" href="#__codelineno-65-1"></a>sudo<span class="w"> </span>nmcli<span class="w"> </span>general<span class="w"> </span>logging<span class="w"> </span>level<span class="w"> </span>INFO<span class="w"> </span>domains<span class="w"> </span>ALL
</span></code></pre></div>
<h2 id="reference-links">Reference Links</h2>
<ul>
<li><a href="https://netplan.readthedocs.io">Netplan documentation</a> - Offical documentation for Netplan. Tutorials, How to Guides, References</li>
<li><a href="https://www.youtube.com/watch?v=6435eNKpyYw">VM Networking Libvirt / Bridge</a> - A youtube video</li>
<li><a href="https://gist.github.com/devantler/6d8bea11f73cc80d00be1502a9437ff0">How to add a static IP in Ubuntu 22.04 Server</a> - A simple example of a Netplan file for a static address</li>
<li><a href="https://askubuntu.com/questions/1257461/error-in-network-definition-bond0-interface-eno2-is-not-defined">Error in network definition: bond0: interface not defined</a> - An example of creating a bond in Netplan.</li>
<li><a href="https://fedorapeople.org/groups/virt/virtio-win/direct-downloads/stable-virtio/virtio-win.iso">use the stable VirtIO ISO, download it from here</a> - Download the Virtio drivers for Windows guests here</li>
<li><a href="https://tuxcare.com/blog/the-essential-kvm-cheat-sheet-for-system-administrators/">The Essential KVM Cheat Sheet for System Administrators</a></li>
<li><a href="https://ravada.readthedocs.io/en/latest/docs/config_console.html">How to enable KVM virsh console access</a> - Create a serial interface on a Linux VM</li>
<li><a href="https://pve.proxmox.com/wiki/Windows_10_guest_best_practices">Windows 10 guest best practices</a> - This video is for ProxMox but the section on installing the virtio drives for the Windows NIC works on KVM with virt manager.</li>
<li><a href="https://developers.redhat.com/blog/2018/10/22/introduction-to-linux-interfaces-for-virtual-networking">Redhat Introduction to Linux interfaces for virtual networking</a> - A great article by Redhat. It discusses every type of Linux interface that you can create.</li>
<li><a href="https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/7/html/virtualization_deployment_and_administration_guide/sect-networking_protocols-routed_mode#sect-Networking_protocols-Routed_mode">Redhat Virtualization Deployment Guide</a> - A great article by Redhat on deploying KVM.</li>
<li><a href="https://www.youtube.com/watch?v=qCUmf5gyOYY">How to Install KVM on Ubuntu 24.04 Step-by-Step</a> - A 25 minute youtube video on installing KVM on Ubuntu.</li>
</ul>







  
  






                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../SSH/" class="md-footer__link md-footer__link--prev" aria-label="Previous: SSH">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                SSH
              </div>
            </div>
          </a>
        
        
          
          <a href="../Join-Ubuntu-24.04-desktop-to-AD/" class="md-footer__link md-footer__link--next" aria-label="Next: Add to AD">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Add to AD
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2024 <a href="https://github.com/rikosintie" target="_blank" rel="noopener">Michael Hubbard</a>

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/rikosintie" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M202.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M496 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/rikosintie" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/mwhubbard/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["content.tabs.link", "content.code.copy", "content.code.annotate", "header.autohide", "navigation.expand", "navigation.footer", "navigation.instant", "navigation.instant.progress", "navigation.path", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "search.highlight", "search.share", "search.suggest", "toc.integrate"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>